#if __DESIGNER_DATA
#error Do not define __DESIGNER_DATA.
<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<om:MetaModel MajorVersion="1" MinorVersion="3" Core="2b131234-7959-458d-834f-2dc0769ce683" ScheduleModel="66366196-361d-448d-976f-cab5e87496d2" xmlns:om="http://schemas.microsoft.com/BizTalk/2003/DesignerData">
    <om:Element Type="Module" OID="6bd6f0e4-5370-4a4c-ae60-506e4c4c8345" LowerBound="1.1" HigherBound="361.1">
        <om:Property Name="ReportToAnalyst" Value="True" />
        <om:Property Name="Name" Value="Sp.Transpak.Orchestrations" />
        <om:Property Name="Signal" Value="False" />
        <om:Element Type="PortType" OID="4fd03794-fc6b-4c84-a6cd-8d810f060aaf" ParentLink="Module_PortType" LowerBound="4.1" HigherBound="11.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_RcvTranspakLHDNSentInvTPS" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="8cbdec83-4f3e-4210-b3c5-7c5918005513" ParentLink="PortType_OperationDeclaration" LowerBound="6.1" HigherBound="10.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="1a05cca5-0340-421a-ad3c-9a5136ad047b" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="8.13" HigherBound="8.110">
                    <om:Property Name="Ref" Value="Sp.Transpak.Schemas.uspLHDNSentTPS_TypedPolling_InterfaceLHDNSentTranspakInvoicesTPS.TypedPolling" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="fde66b72-9512-47b6-9ba2-11c90d7db4cb" ParentLink="Module_PortType" LowerBound="11.1" HigherBound="18.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_SndTranspakTPSInvRespErrorEmail" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="1fcf1b16-ac28-4869-bad3-d159eac7e638" ParentLink="PortType_OperationDeclaration" LowerBound="13.1" HigherBound="17.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="cea0c309-383f-4466-b939-61d6ca959782" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="15.13" HigherBound="15.31">
                    <om:Property Name="Ref" Value="Sp.Transpak.Orchestrations.msgMultiErrorEmail" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="fc1d7a06-9b28-481c-8ded-772486b068f3" ParentLink="Module_PortType" LowerBound="18.1" HigherBound="25.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_SndTranspakInvRespFFTPS" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="c13eaa9b-121f-49dc-8f87-8478d9016c89" ParentLink="PortType_OperationDeclaration" LowerBound="20.1" HigherBound="24.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="023baf78-18fd-4c8e-95f3-8e8e2aa23100" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="22.13" HigherBound="22.56">
                    <om:Property Name="Ref" Value="Sp.Transpak.Schemas.TranspakInvoiceResponse" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="ServiceDeclaration" OID="3b3e392f-5b09-4fec-8230-266903e4ec93" ParentLink="Module_ServiceDeclaration" LowerBound="25.1" HigherBound="360.1">
            <om:Property Name="InitializedTransactionType" Value="False" />
            <om:Property Name="IsInvokable" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="Process_TranspakInvResponse_TPS" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="VariableDeclaration" OID="ba6bce4d-9e8f-4a0b-afd2-5903c0879d49" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="49.1" HigherBound="50.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varValidationDateTime" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="8e040f99-2f12-43d1-ac96-ec3225ed1e9b" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="50.1" HigherBound="51.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varUUID" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="4ad58e0c-e7b0-4eae-b4ee-88001795edb3" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="51.1" HigherBound="52.1">
                <om:Property Name="UseDefaultConstructor" Value="True" />
                <om:Property Name="Type" Value="System.Xml.XmlDocument" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varTempXML" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="f1149c81-ecde-49ca-be34-3998be1a5046" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="52.1" HigherBound="53.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varSubmissionID" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="83b8072f-47d6-49db-91a7-0857eeee5906" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="53.1" HigherBound="54.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varStatusMsg" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="4188490c-ffb1-4d5e-868b-637267a9d993" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="54.1" HigherBound="55.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varStatusCode" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="99106166-421f-4a4b-be44-5746560aca67" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="55.1" HigherBound="56.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varLoopItem" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="20fbe918-1eeb-4198-8025-f0522e11d78e" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="56.1" HigherBound="57.1">
                <om:Property Name="InitialValue" Value="0" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Int32" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varLoopCounter" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="ecd94835-6d74-4120-a823-cdb04a10da91" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="57.1" HigherBound="58.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varLongId" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="b9cffbd3-698b-4cd1-8f24-32928e0cca13" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="58.1" HigherBound="59.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varInvoiceNo" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="b5ef5eb2-f5b2-4d93-b5a9-2401f631e776" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="59.1" HigherBound="60.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varInterfaceStatus" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="80367b26-385a-4af8-9015-65c7a2c87293" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="60.1" HigherBound="61.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varFileName" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="a7c67826-9878-406d-a87b-d11bca8da036" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="61.1" HigherBound="62.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varExceptionmsg" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="77e4206a-7681-4bb3-9cde-124f06a72aaa" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="62.1" HigherBound="63.1">
                <om:Property Name="UseDefaultConstructor" Value="True" />
                <om:Property Name="Type" Value="System.Text.StringBuilder" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varEmailBody" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="cea92d0b-7f55-4fc6-8650-80d8e5024115" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="63.1" HigherBound="64.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varDocId" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="8bc4019d-2ebb-4e6f-985b-a64dd085036a" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="64.1" HigherBound="65.1">
                <om:Property Name="InitialValue" Value="0" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Int32" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varDocCount" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="20746ea5-ff43-412c-8a31-a60f2705ef24" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="40.1" HigherBound="41.1">
                <om:Property Name="Type" Value="Sp.Transpak.Schemas.uspInvoiceStatusupd_TypedProcedure_dbo.InterfaceTranspakInvStatusUpdResponse" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="msgUpdStatusResp" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="57a261a9-8497-4e18-b11d-431c6337ee64" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="41.1" HigherBound="42.1">
                <om:Property Name="Type" Value="Sp.Transpak.Schemas.uspInvoiceStatusupd_TypedProcedure_dbo.InterfaceTranspakInvStatusUpd" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="msgUpdStatusReq" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="c2bb016b-7cec-4118-8f1e-3153b5375880" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="42.1" HigherBound="43.1">
                <om:Property Name="Type" Value="Sp.Transpak.Schemas.uspLHDNSentTPS_TypedPolling_InterfaceLHDNSentTranspakInvoicesTPS.TypedPollingResultSet0" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="msgSingleInvoice" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="0078265a-d314-4cc8-90b1-783ef6432f13" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="43.1" HigherBound="44.1">
                <om:Property Name="Type" Value="Sp.Transpak.Schemas.TranspakInvoiceResponse" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="msgResponseFF" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="dcb449b5-29db-4f1d-9f8e-a7bcfeb91332" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="44.1" HigherBound="45.1">
                <om:Property Name="Type" Value="Sp.Transpak.Schemas.uspLHDNSentTPS_TypedPolling_InterfaceLHDNSentTranspakInvoicesTPS.TypedPolling" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="msgPollInvoices" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="93c48df2-d897-4eee-9480-bef98b9461c7" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="45.1" HigherBound="46.1">
                <om:Property Name="Type" Value="Sp.Transpak.Schemas.uspTranspakInvStatusPeppolDb_TypedProcedure_dbo.InterfaceTranspakInvStatusResponse" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="msgLHDNInvStatusResp" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="79e07d46-dc9f-4902-8d28-3ec5835139a5" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="46.1" HigherBound="47.1">
                <om:Property Name="Type" Value="Sp.Transpak.Schemas.uspTranspakInvStatusPeppolDb_TypedProcedure_dbo.InterfaceTranspakInvStatus" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="msgLHDNInvStatus" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="dbbea481-61bf-49a0-9074-9663f313f612" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="47.1" HigherBound="48.1">
                <om:Property Name="Type" Value="Sp.Transpak.Orchestrations.msgMultiErrorLogs" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="msgErrorLogs" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="9f3238a2-e867-4bbf-b496-16910dc43f0d" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="48.1" HigherBound="49.1">
                <om:Property Name="Type" Value="Sp.Transpak.Orchestrations.msgMultiErrorEmail" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="msgErrorEmail" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="ServiceBody" OID="9ca6050a-82e6-4900-b756-6fd0fd983da0" ParentLink="ServiceDeclaration_ServiceBody">
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="Receive" OID="bca99a99-3c2b-48da-b747-3353d09415c9" ParentLink="ServiceBody_Statement" LowerBound="67.1" HigherBound="85.1">
                    <om:Property Name="Activate" Value="True" />
                    <om:Property Name="PortName" Value="Port_RcvTranspakLHDNSentInvTPS" />
                    <om:Property Name="MessageName" Value="msgPollInvoices" />
                    <om:Property Name="OperationName" Value="Operation_1" />
                    <om:Property Name="OperationMessageName" Value="Request" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Receive_1" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
                <om:Element Type="VariableAssignment" OID="5195b904-c8e4-4752-a4ad-958e602a5e24" ParentLink="ServiceBody_Statement" LowerBound="85.1" HigherBound="89.1">
                    <om:Property Name="Expression" Value="System.Diagnostics.EventLog.WriteEntry(&quot;Transpak_TPS Invoice Response Process Start&quot;,&quot;Transpak_TPS Invoice Response Process Started&quot;);&#xD;&#xA;varDocCount = xpath(msgPollInvoices,&quot;count(/*[local-name()='TypedPolling' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/TypedPolling/InterfaceLHDNSentTranspakInvoicesTPS']/*[local-name()='TypedPollingResultSet0' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/TypedPolling/InterfaceLHDNSentTranspakInvoicesTPS']/*[local-name()='TypedPollingResultSet0' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/TypedPolling/InterfaceLHDNSentTranspakInvoicesTPS']/*[local-name()='DocumentID' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/TypedPolling/InterfaceLHDNSentTranspakInvoicesTPS'])&quot;);&#xD;&#xA;System.Diagnostics.EventLog.WriteEntry(&quot;Transpak_TPS Inv Resp Doc Count&quot;,varDocCount.ToString());&#xD;&#xA;" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Process_Start" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
                <om:Element Type="While" OID="c75432fb-cb90-4d07-a6b2-8f3fb5bc1b69" ParentLink="ServiceBody_Statement" LowerBound="89.1" HigherBound="358.1">
                    <om:Property Name="Expression" Value="varLoopCounter &lt; varDocCount" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Loop_DocumentIds" />
                    <om:Property Name="Signal" Value="True" />
                    <om:Element Type="Scope" OID="71669da5-df2a-4e07-96e5-b01957890885" ParentLink="ComplexStatement_Statement" LowerBound="92.1" HigherBound="355.1">
                        <om:Property Name="InitializedTransactionType" Value="True" />
                        <om:Property Name="IsSynchronized" Value="False" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Scope_PeppolXml" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="VariableAssignment" OID="d753eb33-2698-4597-87ff-64e2afb56c68" ParentLink="ComplexStatement_Statement" LowerBound="97.1" HigherBound="107.1">
                            <om:Property Name="Expression" Value="varLoopCounter = varLoopCounter + 1;&#xD;&#xA;varLoopItem = varLoopCounter.ToString();&#xD;&#xA;&#xD;&#xA;varUUID = &quot;&quot;;&#xD;&#xA;varLongId = &quot;&quot;;&#xD;&#xA;varStatusCode = &quot;&quot;;&#xD;&#xA;varStatusMsg = &quot;&quot;;&#xD;&#xA;varValidationDateTime = &quot;&quot;;&#xD;&#xA;varInterfaceStatus = &quot;&quot;;" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Incr_Counter" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                        <om:Element Type="Construct" OID="7db8b488-f67c-40e7-98f5-dc1bd5a8905c" ParentLink="ComplexStatement_Statement" LowerBound="107.1" HigherBound="120.1">
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Const_SingleDocId" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="MessageRef" OID="348eb626-1df9-4ef3-a9ee-be5fd78d72eb" ParentLink="Construct_MessageRef" LowerBound="108.35" HigherBound="108.51">
                                <om:Property Name="Ref" Value="msgSingleInvoice" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                            <om:Element Type="MessageAssignment" OID="6c42124e-d801-46e9-a4ef-cb77898d3825" ParentLink="ComplexStatement_Statement" LowerBound="110.1" HigherBound="119.1">
                                <om:Property Name="Expression" Value="msgSingleInvoice = xpath(msgPollInvoices, &quot;/*[local-name()='TypedPolling' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/TypedPolling/InterfaceLHDNSentTranspakInvoicesTPS']/*[local-name()='TypedPollingResultSet0' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/TypedPolling/InterfaceLHDNSentTranspakInvoicesTPS']/*[local-name()='TypedPollingResultSet0' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/TypedPolling/InterfaceLHDNSentTranspakInvoicesTPS'][&quot;+ varLoopItem +&quot;]&quot; );&#xD;&#xA;varDocId = msgSingleInvoice.DocumentID;&#xD;&#xA;varInvoiceNo = msgSingleInvoice.DocumentNumber;&#xD;&#xA;varSubmissionID = msgSingleInvoice.SubmissionID;&#xD;&#xA;varInterfaceStatus = msgSingleInvoice.InterfaceStatus;&#xD;&#xA;varStatusMsg = msgSingleInvoice.InterfaceMessage;&#xD;&#xA;varValidationDateTime = msgSingleInvoice.InterfaceDate;&#xD;&#xA;&#xD;&#xA;" />
                                <om:Property Name="ReportToAnalyst" Value="False" />
                                <om:Property Name="Name" Value="MsgAssign_InvoiceHeaderRequest" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                        </om:Element>
                        <om:Element Type="VariableAssignment" OID="e8557692-3243-44a4-8c43-c1214e09e22a" ParentLink="ComplexStatement_Statement" LowerBound="120.1" HigherBound="139.1">
                            <om:Property Name="Expression" Value="&#xA;if(System.Convert.ToString(Sp.Transpak.Common.SSOClientHelper.Read(&quot;Sp.Transpak&quot;, &quot;ShowTranspakAdminLogs&quot;)) == &quot;Yes&quot;)&#xA;{&#xA;    System.Diagnostics.EventLog.WriteEntry(&quot;varDocId&quot;,varDocId);&#xA;    System.Diagnostics.EventLog.WriteEntry(&quot;InvoiceNo&quot;,varInvoiceNo);&#xA;    System.Diagnostics.EventLog.WriteEntry(&quot;varInterfaceStatus&quot;,varInterfaceStatus);&#xA;    System.Diagnostics.EventLog.WriteEntry(&quot;varStatusMsg&quot;,varStatusMsg);&#xA;    varTempXML = new System.Xml.XmlDocument();&#xA;    varTempXML = msgSingleInvoice;&#xA;    if(varTempXML.OuterXml.Length &lt; 30000)&#xA;    {&#xA;        System.Diagnostics.EventLog.WriteEntry(&quot;msgSingleInvoice&quot;,varTempXML.OuterXml);&#xA;    }&#xA;    else&#xA;    {&#xA;        System.Diagnostics.EventLog.WriteEntry(&quot;msgSingleInvoice&quot;,varTempXML.OuterXml.Substring(0,29500));&#xA;    }&#xA;}" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="ShowLogs" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                        <om:Element Type="Decision" OID="1d9c6303-15c4-4254-bd4a-13288b8e22e2" ParentLink="ComplexStatement_Statement" LowerBound="139.1" HigherBound="294.1">
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Chk_LHDNSent" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="DecisionBranch" OID="2efebe6a-ec71-45ab-98e3-3627e02f2951" ParentLink="ReallyComplexStatement_Branch" LowerBound="140.25" HigherBound="267.1">
                                <om:Property Name="Expression" Value="varInterfaceStatus == &quot;LHDNSent&quot;" />
                                <om:Property Name="IsGhostBranch" Value="True" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="LHDNSent" />
                                <om:Property Name="Signal" Value="False" />
                                <om:Element Type="Construct" OID="367c22ea-5d4c-4f23-b24c-af416cbf191d" ParentLink="ComplexStatement_Statement" LowerBound="142.1" HigherBound="150.1">
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Const_GetPeppolDBData" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="MessageAssignment" OID="134fda47-e97a-4840-aef4-03b1931b2111" ParentLink="ComplexStatement_Statement" LowerBound="145.1" HigherBound="149.1">
                                        <om:Property Name="Expression" Value="varTempXML = new System.Xml.XmlDocument();&#xD;&#xA;varTempXML.LoadXml(&quot;&lt;ns0:InterfaceTranspakInvStatus xmlns:ns0='http://schemas.microsoft.com/Sql/2008/05/TypedProcedures/dbo'&gt;&lt;ns0:DocumentID&gt;&quot; + varSubmissionID + &quot;&lt;/ns0:DocumentID&gt;&lt;ns0:InvoiceNumber&gt;&quot; + varInvoiceNo + &quot;&lt;/ns0:InvoiceNumber&gt;&lt;/ns0:InterfaceTranspakInvStatus&gt;&quot;);&#xD;&#xA;msgLHDNInvStatus = varTempXML;" />
                                        <om:Property Name="ReportToAnalyst" Value="False" />
                                        <om:Property Name="Name" Value="MessageAssignment_6" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                    <om:Element Type="MessageRef" OID="ecae58ed-4f23-4731-90ce-8cbb423722f7" ParentLink="Construct_MessageRef" LowerBound="143.39" HigherBound="143.55">
                                        <om:Property Name="Ref" Value="msgLHDNInvStatus" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="VariableAssignment" OID="68ef7f3b-61ec-4fe6-9bc8-c6a45dfb4664" ParentLink="ComplexStatement_Statement" LowerBound="150.1" HigherBound="165.1">
                                    <om:Property Name="Expression" Value="&#xA;if(System.Convert.ToString(Sp.Transpak.Common.SSOClientHelper.Read(&quot;Sp.Transpak&quot;, &quot;ShowTranspakAdminLogs&quot;)) == &quot;Yes&quot;)&#xA;{&#xA;    varTempXML = new System.Xml.XmlDocument();&#xA;    varTempXML = msgLHDNInvStatus;&#xA;    if(varTempXML.OuterXml.Length &lt; 30000)&#xA;    {&#xA;        System.Diagnostics.EventLog.WriteEntry(&quot;msgLHDNInvStatus&quot;,varTempXML.OuterXml);&#xA;    }&#xA;    else&#xA;    {&#xA;        System.Diagnostics.EventLog.WriteEntry(&quot;msgLHDNInvStatus&quot;,varTempXML.OuterXml.Substring(1,29500));&#xA;    }&#xA;}" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="ShowLogs" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="Send" OID="5c780aaa-11ae-41cc-9a1b-48e663bc4ac1" ParentLink="ComplexStatement_Statement" LowerBound="165.1" HigherBound="167.1">
                                    <om:Property Name="PortName" Value="Port_SndRcvTranspakInvStatusPeppolDB" />
                                    <om:Property Name="MessageName" Value="msgLHDNInvStatus" />
                                    <om:Property Name="OperationName" Value="Operation_1" />
                                    <om:Property Name="OperationMessageName" Value="Request" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Send_2" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                                <om:Element Type="Receive" OID="6c7634d3-d03d-4cfc-8c8f-426179a9d7ba" ParentLink="ComplexStatement_Statement" LowerBound="167.1" HigherBound="169.1">
                                    <om:Property Name="Activate" Value="False" />
                                    <om:Property Name="PortName" Value="Port_SndRcvTranspakInvStatusPeppolDB" />
                                    <om:Property Name="MessageName" Value="msgLHDNInvStatusResp" />
                                    <om:Property Name="OperationName" Value="Operation_1" />
                                    <om:Property Name="OperationMessageName" Value="Response" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Receive_2" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                                <om:Element Type="VariableAssignment" OID="db7e47c6-6e84-4c44-997b-bf45bfe0e32a" ParentLink="ComplexStatement_Statement" LowerBound="169.1" HigherBound="183.1">
                                    <om:Property Name="Expression" Value="if(System.Convert.ToString(Sp.Transpak.Common.SSOClientHelper.Read(&quot;Sp.Transpak&quot;, &quot;ShowTranspakAdminLogs&quot;)) == &quot;Yes&quot;)&#xA;{&#xA;    varTempXML = new System.Xml.XmlDocument();&#xA;    varTempXML = msgLHDNInvStatusResp;&#xA;    if(varTempXML.OuterXml.Length &lt; 30000)&#xA;    {&#xA;        System.Diagnostics.EventLog.WriteEntry(&quot;msgLHDNInvStatusResp&quot;,varTempXML.OuterXml);&#xA;    }&#xA;    else&#xA;    {&#xA;        System.Diagnostics.EventLog.WriteEntry(&quot;msgLHDNInvStatusResp&quot;,varTempXML.OuterXml.Substring(0,29500));&#xA;    }&#xA;}" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="ShowLogs" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                                <om:Element Type="VariableAssignment" OID="9d66e640-8f5d-469b-9306-5ea04ca5a373" ParentLink="ComplexStatement_Statement" LowerBound="183.1" HigherBound="190.1">
                                    <om:Property Name="Expression" Value="varUUID = xpath(msgLHDNInvStatusResp,&quot;string(/*[local-name()='InterfaceTranspakInvStatusResponse' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/TypedProcedures/dbo']/*[local-name()='StoredProcedureResultSet0' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/TypedProcedures/dbo']/*[local-name()='StoredProcedureResultSet0' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/ProceduresResultSets/dbo/InterfaceTranspakInvStatus']/*[local-name()='UUID' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/ProceduresResultSets/dbo/InterfaceTranspakInvStatus']/text())&quot;);&#xD;&#xA;varLongId = xpath(msgLHDNInvStatusResp,&quot;string(/*[local-name()='InterfaceTranspakInvStatusResponse' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/TypedProcedures/dbo']/*[local-name()='StoredProcedureResultSet0' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/TypedProcedures/dbo']/*[local-name()='StoredProcedureResultSet0' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/ProceduresResultSets/dbo/InterfaceTranspakInvStatus']/*[local-name()='LongId' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/ProceduresResultSets/dbo/InterfaceTranspakInvStatus']/text())&quot;);&#xD;&#xA;varStatusCode = xpath(msgLHDNInvStatusResp,&quot;string(/*[local-name()='InterfaceTranspakInvStatusResponse' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/TypedProcedures/dbo']/*[local-name()='StoredProcedureResultSet0' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/TypedProcedures/dbo']/*[local-name()='StoredProcedureResultSet0' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/ProceduresResultSets/dbo/InterfaceTranspakInvStatus']/*[local-name()='Status' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/ProceduresResultSets/dbo/InterfaceTranspakInvStatus']/text())&quot;);&#xD;&#xA;varStatusMsg = xpath(msgLHDNInvStatusResp,&quot;string(/*[local-name()='InterfaceTranspakInvStatusResponse' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/TypedProcedures/dbo']/*[local-name()='StoredProcedureResultSet0' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/TypedProcedures/dbo']/*[local-name()='StoredProcedureResultSet0' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/ProceduresResultSets/dbo/InterfaceTranspakInvStatus']/*[local-name()='Message' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/ProceduresResultSets/dbo/InterfaceTranspakInvStatus']/text())&quot;);&#xD;&#xA;varValidationDateTime = xpath(msgLHDNInvStatusResp,&quot;string(/*[local-name()='InterfaceTranspakInvStatusResponse' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/TypedProcedures/dbo']/*[local-name()='StoredProcedureResultSet0' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/TypedProcedures/dbo']/*[local-name()='StoredProcedureResultSet0' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/ProceduresResultSets/dbo/InterfaceTranspakInvStatus']/*[local-name()='ValidationDateTime' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/ProceduresResultSets/dbo/InterfaceTranspakInvStatus']/text())&quot;);&#xD;&#xA;varInterfaceStatus = xpath(msgLHDNInvStatusResp,&quot;string(/*[local-name()='InterfaceTranspakInvStatusResponse' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/TypedProcedures/dbo']/*[local-name()='StoredProcedureResultSet0' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/TypedProcedures/dbo']/*[local-name()='StoredProcedureResultSet0' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/ProceduresResultSets/dbo/InterfaceTranspakInvStatus']/*[local-name()='InterfaceStatus' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/ProceduresResultSets/dbo/InterfaceTranspakInvStatus']/text())&quot;);" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="AssignVar" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                                <om:Element Type="Decision" OID="e0424fc6-b1e6-4e87-a47f-788ebcd72934" ParentLink="ComplexStatement_Statement" LowerBound="190.1" HigherBound="266.1">
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Chk_Empty_Resp" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="DecisionBranch" OID="5e1c7abd-3d02-4947-8c09-878c0b98892c" ParentLink="ReallyComplexStatement_Branch" LowerBound="191.29" HigherBound="194.1">
                                        <om:Property Name="Expression" Value="varStatusCode == &quot;&quot;" />
                                        <om:Property Name="IsGhostBranch" Value="True" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="If_Empty" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                    <om:Element Type="DecisionBranch" OID="7887dea2-9b1d-4146-b7c9-ae4295cd5be2" ParentLink="ReallyComplexStatement_Branch">
                                        <om:Property Name="IsGhostBranch" Value="True" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Else" />
                                        <om:Property Name="Signal" Value="False" />
                                        <om:Element Type="Construct" OID="a0ae43b4-fe1b-499c-b5b8-b5e5c5241f46" ParentLink="ComplexStatement_Statement" LowerBound="196.1" HigherBound="206.1">
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="Const_RespFF" />
                                            <om:Property Name="Signal" Value="True" />
                                            <om:Element Type="MessageRef" OID="de4928e8-3049-4270-8b61-e774a71aec55" ParentLink="Construct_MessageRef" LowerBound="197.43" HigherBound="197.56">
                                                <om:Property Name="Ref" Value="msgResponseFF" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                            <om:Element Type="MessageAssignment" OID="c384f277-641c-4609-84d0-c7e91077a3b3" ParentLink="ComplexStatement_Statement" LowerBound="199.1" HigherBound="205.1">
                                                <om:Property Name="Expression" Value="varTempXML = new System.Xml.XmlDocument();&#xD;&#xA;varTempXML.LoadXml(&quot;&lt;InvoiceResponse&gt;&lt;InvoiceNumber&gt;&quot; + varInvoiceNo + &quot;&lt;/InvoiceNumber&gt;&lt;UUID&gt;&quot; + varUUID + &quot;&lt;/UUID&gt;&lt;LongID&gt;&quot; + varLongId + &quot;&lt;/LongID&gt;&lt;StatusCode&gt;&quot; + varStatusCode + &quot;&lt;/StatusCode&gt;&lt;StatusMessage&gt;&quot; + varStatusMsg + &quot;&lt;/StatusMessage&gt;&lt;ValidationDateTime&gt;&quot; + varValidationDateTime + &quot;&lt;/ValidationDateTime&gt;&lt;/InvoiceResponse&gt;&quot;);&#xD;&#xA;msgResponseFF = varTempXML;&#xD;&#xA;varFileName = &quot;TPS_IR_&quot; + varInvoiceNo + &quot;_&quot; + System.DateTime.Now.ToString(&quot;yyyyMMddHHmmssfff&quot;) + &quot;.xml&quot;;&#xD;&#xA;msgResponseFF(FILE.ReceivedFileName) = varFileName;" />
                                                <om:Property Name="ReportToAnalyst" Value="False" />
                                                <om:Property Name="Name" Value="MessageAssignment_2" />
                                                <om:Property Name="Signal" Value="True" />
                                            </om:Element>
                                        </om:Element>
                                        <om:Element Type="VariableAssignment" OID="7100c706-1d86-4fe3-886b-eee70cd121ef" ParentLink="ComplexStatement_Statement" LowerBound="206.1" HigherBound="221.1">
                                            <om:Property Name="Expression" Value="&#xA;if(System.Convert.ToString(Sp.Transpak.Common.SSOClientHelper.Read(&quot;Sp.Transpak&quot;, &quot;ShowTranspakAdminLogs&quot;)) == &quot;Yes&quot;)&#xA;{&#xA;    varTempXML = new System.Xml.XmlDocument();&#xA;    varTempXML = msgResponseFF;&#xA;    if(varTempXML.OuterXml.Length &lt; 30000)&#xA;    {&#xA;        System.Diagnostics.EventLog.WriteEntry(&quot;msgResponseFF&quot;,varTempXML.OuterXml);&#xA;    }&#xA;    else&#xA;    {&#xA;        System.Diagnostics.EventLog.WriteEntry(&quot;msgResponseFF&quot;,varTempXML.OuterXml.Substring(0,29500));&#xA;    }&#xA;}" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="ShowLogs" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                        <om:Element Type="Construct" OID="2b765f08-2c7e-4a6f-92bd-26085ce55e75" ParentLink="ComplexStatement_Statement" LowerBound="221.1" HigherBound="229.1">
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="Const_UpdStatusUpd" />
                                            <om:Property Name="Signal" Value="True" />
                                            <om:Element Type="MessageAssignment" OID="94c0c460-734b-4fa5-acff-9d39220b3e80" ParentLink="ComplexStatement_Statement" LowerBound="224.1" HigherBound="228.1">
                                                <om:Property Name="Expression" Value="varTempXML = new System.Xml.XmlDocument();&#xD;&#xA;varTempXML.LoadXml(&quot;&lt;ns0:InterfaceTranspakInvStatusUpd xmlns:ns0='http://schemas.microsoft.com/Sql/2008/05/TypedProcedures/dbo'&gt;&lt;ns0:DocumentID&gt;&quot; + varDocId + &quot;&lt;/ns0:DocumentID&gt;&lt;ns0:StatusType&gt;LHDN&lt;/ns0:StatusType&gt;&lt;ns0:Status&gt;&quot; + varInterfaceStatus + &quot;&lt;/ns0:Status&gt;&lt;ns0:StatusMessage&gt;&quot; + varStatusMsg + &quot;&lt;/ns0:StatusMessage&gt;&lt;ns0:StatusDateTime&gt;&quot; + varValidationDateTime + &quot;&lt;/ns0:StatusDateTime&gt;&lt;ns0:PeppolInvoiceXMLPath&gt;-&lt;/ns0:PeppolInvoiceXMLPath&gt;&lt;/ns0:InterfaceTranspakInvStatusUpd&gt;&quot;);&#xD;&#xA;msgUpdStatusReq = varTempXML;&#xD;&#xA;" />
                                                <om:Property Name="ReportToAnalyst" Value="False" />
                                                <om:Property Name="Name" Value="MessageAssignment_4" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                            <om:Element Type="MessageRef" OID="23ca50c1-6488-430c-a2da-055b939ac429" ParentLink="Construct_MessageRef" LowerBound="222.43" HigherBound="222.58">
                                                <om:Property Name="Ref" Value="msgUpdStatusReq" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                        </om:Element>
                                        <om:Element Type="VariableAssignment" OID="1ce78d6e-e024-4366-957c-e08fc07ace42" ParentLink="ComplexStatement_Statement" LowerBound="229.1" HigherBound="244.1">
                                            <om:Property Name="Expression" Value="&#xA;if(System.Convert.ToString(Sp.Transpak.Common.SSOClientHelper.Read(&quot;Sp.Transpak&quot;, &quot;ShowTranspakAdminLogs&quot;)) == &quot;Yes&quot;)&#xA;{&#xA;    varTempXML = new System.Xml.XmlDocument();&#xA;    varTempXML = msgUpdStatusReq;&#xA;    if(varTempXML.OuterXml.Length &lt; 30000)&#xA;    {&#xA;        System.Diagnostics.EventLog.WriteEntry(&quot;msgInvStatusUpdReq&quot;,varTempXML.OuterXml);&#xA;    }&#xA;    else&#xA;    {&#xA;        System.Diagnostics.EventLog.WriteEntry(&quot;msgInvStatusUpdReq&quot;,varTempXML.OuterXml.Substring(1,29500));&#xA;    }&#xA;}" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="ShowLogs" />
                                            <om:Property Name="Signal" Value="True" />
                                        </om:Element>
                                        <om:Element Type="Send" OID="e7c5fbd8-11bb-4460-b2c7-88c6c15234d7" ParentLink="ComplexStatement_Statement" LowerBound="244.1" HigherBound="246.1">
                                            <om:Property Name="PortName" Value="Port_SndRcvTranspakInvStatusUpd" />
                                            <om:Property Name="MessageName" Value="msgUpdStatusReq" />
                                            <om:Property Name="OperationName" Value="Operation_1" />
                                            <om:Property Name="OperationMessageName" Value="Request" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="Send_1" />
                                            <om:Property Name="Signal" Value="True" />
                                        </om:Element>
                                        <om:Element Type="Receive" OID="e05a1904-7abc-4f1d-bf1b-fa23fe8f278f" ParentLink="ComplexStatement_Statement" LowerBound="246.1" HigherBound="248.1">
                                            <om:Property Name="Activate" Value="False" />
                                            <om:Property Name="PortName" Value="Port_SndRcvTranspakInvStatusUpd" />
                                            <om:Property Name="MessageName" Value="msgUpdStatusResp" />
                                            <om:Property Name="OperationName" Value="Operation_1" />
                                            <om:Property Name="OperationMessageName" Value="Response" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="Receive_3" />
                                            <om:Property Name="Signal" Value="True" />
                                        </om:Element>
                                        <om:Element Type="VariableAssignment" OID="932fb5bd-f3ef-4b86-9390-492717547b17" ParentLink="ComplexStatement_Statement" LowerBound="248.1" HigherBound="263.1">
                                            <om:Property Name="Expression" Value="&#xA;if(System.Convert.ToString(Sp.Transpak.Common.SSOClientHelper.Read(&quot;Sp.Transpak&quot;, &quot;ShowTranspakAdminLogs&quot;)) == &quot;Yes&quot;)&#xA;{&#xA;    varTempXML = new System.Xml.XmlDocument();&#xA;    varTempXML = msgUpdStatusResp;&#xA;    if(varTempXML.OuterXml.Length &lt; 30000)&#xA;    {&#xA;        System.Diagnostics.EventLog.WriteEntry(&quot;msgUpdStatusResp&quot;,varTempXML.OuterXml);&#xA;    }&#xA;    else&#xA;    {&#xA;        System.Diagnostics.EventLog.WriteEntry(&quot;msgUpdStatusResp&quot;,varTempXML.OuterXml.Substring(0,29500));&#xA;    }&#xA;}" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="ShowLogs" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                        <om:Element Type="Send" OID="f999dc77-ad9c-40d4-8895-9dafc4ddf84d" ParentLink="ComplexStatement_Statement" LowerBound="263.1" HigherBound="265.1">
                                            <om:Property Name="PortName" Value="Port_SndTranspakInvRespFFTPS" />
                                            <om:Property Name="MessageName" Value="msgResponseFF" />
                                            <om:Property Name="OperationName" Value="Operation_1" />
                                            <om:Property Name="OperationMessageName" Value="Request" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="Send_5" />
                                            <om:Property Name="Signal" Value="True" />
                                        </om:Element>
                                    </om:Element>
                                </om:Element>
                            </om:Element>
                            <om:Element Type="DecisionBranch" OID="b5e7a8ea-b055-4313-bc5d-df8e84670149" ParentLink="ReallyComplexStatement_Branch">
                                <om:Property Name="IsGhostBranch" Value="True" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Else" />
                                <om:Property Name="Signal" Value="False" />
                                <om:Element Type="Construct" OID="2a3f58dc-0767-4da5-9a82-996fbffc83cb" ParentLink="ComplexStatement_Statement" LowerBound="269.1" HigherBound="279.1">
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Const_msgRespFF" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="MessageAssignment" OID="7bfcd48f-2e80-4607-98e0-e78921d7febf" ParentLink="ComplexStatement_Statement" LowerBound="272.1" HigherBound="278.1">
                                        <om:Property Name="Expression" Value="varTempXML = new System.Xml.XmlDocument();&#xD;&#xA;varTempXML.LoadXml(&quot;&lt;InvoiceResponse&gt;&lt;InvoiceNumber&gt;&quot; + varInvoiceNo + &quot;&lt;/InvoiceNumber&gt;&lt;UUID&gt;-&lt;/UUID&gt;&lt;LongID&gt;-&lt;/LongID&gt;&lt;StatusCode&gt;&quot; + varInterfaceStatus + &quot;&lt;/StatusCode&gt;&lt;StatusMessage&gt;&quot; + varStatusMsg + &quot;&lt;/StatusMessage&gt;&lt;ValidationDateTime&gt;&quot; + varValidationDateTime + &quot;&lt;/ValidationDateTime&gt;&lt;/InvoiceResponse&gt;&quot;);&#xD;&#xA;msgResponseFF = varTempXML;&#xD;&#xA;varFileName = &quot;TPS_IR_&quot; + varInvoiceNo + &quot;_&quot; + System.DateTime.Now.ToString(&quot;yyyyMMddHHmmssfff&quot;) + &quot;.xml&quot;;&#xD;&#xA;msgResponseFF(FILE.ReceivedFileName) = varFileName;" />
                                        <om:Property Name="ReportToAnalyst" Value="False" />
                                        <om:Property Name="Name" Value="MessageAssignment_2" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                    <om:Element Type="MessageRef" OID="c9dc24e3-9f82-4d82-ab81-2a9361c7eecf" ParentLink="Construct_MessageRef" LowerBound="270.39" HigherBound="270.52">
                                        <om:Property Name="Ref" Value="msgResponseFF" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="Construct" OID="9de98355-9eeb-4559-abe0-90a1e8c7ebb3" ParentLink="ComplexStatement_Statement" LowerBound="279.1" HigherBound="287.1">
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Const_UpdStatusUpd" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="MessageAssignment" OID="ef32fbd7-74f0-4f85-acb3-7168b0ff717b" ParentLink="ComplexStatement_Statement" LowerBound="282.1" HigherBound="286.1">
                                        <om:Property Name="Expression" Value="varTempXML = new System.Xml.XmlDocument();&#xD;&#xA;varTempXML.LoadXml(&quot;&lt;ns0:InterfaceTranspakInvStatusUpd xmlns:ns0='http://schemas.microsoft.com/Sql/2008/05/TypedProcedures/dbo'&gt;&lt;ns0:DocumentID&gt;&quot; + varDocId + &quot;&lt;/ns0:DocumentID&gt;&lt;ns0:StatusType&gt;LHDN&lt;/ns0:StatusType&gt;&lt;ns0:Status&gt;&quot; + varInterfaceStatus + &quot;&lt;/ns0:Status&gt;&lt;ns0:StatusMessage&gt;&quot; + varStatusMsg + &quot;&lt;/ns0:StatusMessage&gt;&lt;ns0:StatusDateTime&gt;&quot; + varValidationDateTime + &quot;&lt;/ns0:StatusDateTime&gt;&lt;ns0:PeppolInvoiceXMLPath&gt;-&lt;/ns0:PeppolInvoiceXMLPath&gt;&lt;/ns0:InterfaceTranspakInvStatusUpd&gt;&quot;);&#xD;&#xA;msgUpdStatusReq = varTempXML;&#xD;&#xA;" />
                                        <om:Property Name="ReportToAnalyst" Value="False" />
                                        <om:Property Name="Name" Value="MessageAssignment_4" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                    <om:Element Type="MessageRef" OID="57064523-6562-4741-9d5c-7dfbfd88823e" ParentLink="Construct_MessageRef" LowerBound="280.39" HigherBound="280.54">
                                        <om:Property Name="Ref" Value="msgUpdStatusReq" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="Send" OID="f26ce7cc-18b4-4c34-b549-0e1a58ad9ca8" ParentLink="ComplexStatement_Statement" LowerBound="287.1" HigherBound="289.1">
                                    <om:Property Name="PortName" Value="Port_SndRcvTranspakInvStatusUpd" />
                                    <om:Property Name="MessageName" Value="msgUpdStatusReq" />
                                    <om:Property Name="OperationName" Value="Operation_1" />
                                    <om:Property Name="OperationMessageName" Value="Request" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Send_1" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                                <om:Element Type="Receive" OID="003d44a3-ca99-425f-98c0-ac51d624d22e" ParentLink="ComplexStatement_Statement" LowerBound="289.1" HigherBound="291.1">
                                    <om:Property Name="Activate" Value="False" />
                                    <om:Property Name="PortName" Value="Port_SndRcvTranspakInvStatusUpd" />
                                    <om:Property Name="MessageName" Value="msgUpdStatusResp" />
                                    <om:Property Name="OperationName" Value="Operation_1" />
                                    <om:Property Name="OperationMessageName" Value="Response" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Receive_3" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                                <om:Element Type="Send" OID="6e55a3e2-546a-41db-886f-db9dfe926a18" ParentLink="ComplexStatement_Statement" LowerBound="291.1" HigherBound="293.1">
                                    <om:Property Name="PortName" Value="Port_SndTranspakInvRespFFTPS" />
                                    <om:Property Name="MessageName" Value="msgResponseFF" />
                                    <om:Property Name="OperationName" Value="Operation_1" />
                                    <om:Property Name="OperationMessageName" Value="Request" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Send_6" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                            </om:Element>
                        </om:Element>
                        <om:Element Type="Catch" OID="ff283a19-61ba-4795-9884-3e85e321f06d" ParentLink="Scope_Catch" LowerBound="297.1" HigherBound="353.1">
                            <om:Property Name="ExceptionName" Value="ex" />
                            <om:Property Name="ExceptionType" Value="System.Exception" />
                            <om:Property Name="IsFaultMessage" Value="False" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="System Exception" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="VariableAssignment" OID="f8eb2fec-d5ee-4c88-af5f-bd308374e321" ParentLink="Catch_Statement" LowerBound="300.1" HigherBound="311.1">
                                <om:Property Name="Expression" Value="System.Diagnostics.EventLog.WriteEntry(&quot;TranspakTPS_APIUpdateException&quot;,ex.Message);&#xD;&#xA;varExceptionmsg = ex.Message;&#xD;&#xA;varExceptionmsg = varExceptionmsg.Replace(&quot;&amp;&quot;,&quot;&amp;amp;&quot;);&#xD;&#xA;varExceptionmsg = varExceptionmsg.Replace(&quot;'&quot;,&quot;''&quot;);&#xD;&#xA;varExceptionmsg = varExceptionmsg.Replace(&quot;&lt;&quot;,&quot;&amp;lt;&quot;);&#xD;&#xA;varExceptionmsg = varExceptionmsg.Replace(&quot;&gt;&quot;,&quot;&amp;gt;&quot;);&#xD;&#xA;if(varExceptionmsg.Length &gt; 1000)&#xD;&#xA;{&#xD;&#xA;    varExceptionmsg = varExceptionmsg.Substring(0,999);&#xD;&#xA;}" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="ExceptionMsg" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                            <om:Element Type="Construct" OID="5c4e04a0-ea8e-4534-b993-c1c92af8815d" ParentLink="Catch_Statement" LowerBound="311.1" HigherBound="320.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="const_ErrorLogsTable" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="MessageRef" OID="59d1f7e0-b6c2-4551-861b-58d20e2cd698" ParentLink="Construct_MessageRef" LowerBound="312.39" HigherBound="312.51">
                                    <om:Property Name="Ref" Value="msgErrorLogs" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="MessageAssignment" OID="5cff6c79-638a-446d-98ea-6fe7a1820baf" ParentLink="ComplexStatement_Statement" LowerBound="314.1" HigherBound="319.1">
                                    <om:Property Name="Expression" Value="varTempXML = new System.Xml.XmlDocument();&#xD;&#xA;varTempXML.LoadXml(&quot;&lt;ns0:InterfaceErrorLogs xmlns:ns0='http://schemas.microsoft.com/Sql/2008/05/TypedProcedures/dbo'&gt;&lt;ns0:HubID&gt;TSP&lt;/ns0:HubID&gt;&lt;ns0:DocumentID&gt;&quot; + varDocId + &quot;&lt;/ns0:DocumentID&gt;&lt;ns0:DocumentType&gt;TSPInvoiceResponse&lt;/ns0:DocumentType&gt;&lt;ns0:DocumentNumber&gt;&quot; + varInvoiceNo + &quot;&lt;/ns0:DocumentNumber&gt;&lt;ns0:ModuleName&gt;Process_TranspakInvResponse_TSP&lt;/ns0:ModuleName&gt;&lt;ns0:ExceptionType&gt;&quot; + ex.Source + &quot;&lt;/ns0:ExceptionType&gt;&lt;ns0:ErrorMessage&gt;&quot; + varExceptionmsg + &quot;&lt;/ns0:ErrorMessage&gt;&lt;ns0:VendorCode&gt;-&lt;/ns0:VendorCode&gt;&lt;ns0:DocumentPath&gt;-&lt;/ns0:DocumentPath&gt;&lt;/ns0:InterfaceErrorLogs&gt;&quot;);&#xD;&#xA;msgErrorLogs.Body = varTempXML;&#xD;&#xA;&#xD;&#xA;" />
                                    <om:Property Name="ReportToAnalyst" Value="False" />
                                    <om:Property Name="Name" Value="MessageAssignment_3" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Send" OID="7f67b307-8bdf-48c2-9aed-ccd434dd3abd" ParentLink="Catch_Statement" LowerBound="320.1" HigherBound="322.1">
                                <om:Property Name="PortName" Value="Port_SndTranspakErrorLogs" />
                                <om:Property Name="MessageName" Value="msgErrorLogs" />
                                <om:Property Name="OperationName" Value="Operation_1" />
                                <om:Property Name="OperationMessageName" Value="Request" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Send_4" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                            <om:Element Type="Construct" OID="ba0bfa96-c553-4890-817f-49095bb92965" ParentLink="Catch_Statement" LowerBound="322.1" HigherBound="350.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Const_ErrorEmail" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="MessageRef" OID="6af4f0b4-fdae-44b2-bd4b-ec7e9adda521" ParentLink="Construct_MessageRef" LowerBound="323.39" HigherBound="323.52">
                                    <om:Property Name="Ref" Value="msgErrorEmail" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="MessageAssignment" OID="ee060a84-694e-4f00-a608-7863bc9ca947" ParentLink="ComplexStatement_Statement" LowerBound="325.1" HigherBound="349.1">
                                    <om:Property Name="Expression" Value="System.Diagnostics.EventLog.WriteEntry(&quot;TranspakTPSInvRespException&quot;,ex.Message);&#xD;&#xA;&#xD;&#xA;varEmailBody = new System.Text.StringBuilder();&#xD;&#xA;varEmailBody.AppendLine(&quot;&lt;html&gt;&lt;body&gt;&quot;);&#xD;&#xA;varEmailBody.AppendLine(&quot;&lt;p&gt;Transpak_TPS Invoice Resp Status update failed while Updating in SESAMi.&lt;/p&gt;&quot;);&#xD;&#xA;varEmailBody.AppendLine(&quot;&lt;p&gt;&lt;b&gt;&lt;u&gt;Error details:&lt;/u&gt;&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&quot;);&#xD;&#xA;varEmailBody.AppendLine(&quot;&lt;b&gt;Application Name&lt;/b&gt; : &lt;i&gt;Sp.Transpak&lt;/i&gt;&lt;br/&gt;&quot;);&#xD;&#xA;varEmailBody.AppendLine(&quot;&lt;b&gt;Process Name&lt;/b&gt; : &lt;i&gt;Process_TranspakInvResponse_TSP&lt;/i&gt;&lt;br/&gt;&quot;);&#xD;&#xA;varEmailBody.AppendLine(&quot;&lt;b&gt;DocId&lt;/b&gt; : &lt;i&gt;&quot; + varDocId  + &quot;&lt;/i&gt;&lt;br/&gt;&quot;);&#xD;&#xA;varEmailBody.AppendLine(&quot;&lt;b&gt;Failure Code&lt;/b&gt; : &quot; + ex.Source + &quot;&lt;br/&gt;&quot;);&#xD;&#xA;varEmailBody.AppendLine(&quot;&lt;b&gt;Error Description&lt;/b&gt; : &lt;i&gt;&quot; + ex.Message + &quot;&lt;/i&gt;&lt;br/&gt;&quot;);&#xD;&#xA;varEmailBody.AppendLine(&quot;&lt;/body&gt;&lt;/html&gt;&quot;);&#xD;&#xA;msgErrorEmail.Body = new Sp.Transpak.Common.RawString(varEmailBody.ToString());&#xD;&#xA;Sp.Transpak.Common.SMTPUtils.SetContentType(msgErrorEmail.Body,&quot;text/html&quot;);&#xD;&#xA;Port_SndTranspakTPSInvRespErrorEmail(Microsoft.XLANGs.BaseTypes.Address) = Sp.Transpak.Common.SSOClientHelper.Read(&quot;Sp.Transpak&quot;, &quot;SMTPTo&quot;);&#xD;&#xA;&#xD;&#xA;msgErrorEmail(SMTP.From) = Sp.Transpak.Common.SSOClientHelper.Read(&quot;Sp.Transpak&quot;, &quot;SMTPFrom&quot;);&#xD;&#xA;&#xD;&#xA;msgErrorEmail(SMTP.Subject) = &quot;Transpak TPS Invoice Resp status failed while updating status for Invoice: &quot; + varInvoiceNo;&#xD;&#xA;&#xD;&#xA;msgErrorEmail(SMTP.EmailBodyFileCharset) = &quot;UTF-8&quot;;&#xD;&#xA;msgErrorEmail(SMTP.CC) = Sp.Transpak.Common.SSOClientHelper.Read(&quot;Sp.Transpak&quot;, &quot;SMTPCCopy&quot;);&#xD;&#xA;msgErrorEmail(SMTP.SMTPHost)= Sp.Transpak.Common.SSOClientHelper.Read(&quot;Sp.Transpak&quot;, &quot;SMTPHost&quot;);" />
                                    <om:Property Name="ReportToAnalyst" Value="False" />
                                    <om:Property Name="Name" Value="MessageAssignment_1" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Send" OID="279b71da-fff2-4207-b3b0-16cb3990baf3" ParentLink="Catch_Statement" LowerBound="350.1" HigherBound="352.1">
                                <om:Property Name="PortName" Value="Port_SndTranspakTPSInvRespErrorEmail" />
                                <om:Property Name="MessageName" Value="msgErrorEmail" />
                                <om:Property Name="OperationName" Value="Operation_1" />
                                <om:Property Name="OperationMessageName" Value="Request" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Send_3" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                        </om:Element>
                    </om:Element>
                    <om:Element Type="Delay" OID="4a236543-822d-4742-ac75-3526020e43ed" ParentLink="ComplexStatement_Statement" LowerBound="355.1" HigherBound="357.1">
                        <om:Property Name="Timeout" Value="new System.TimeSpan(0,0,0,0,System.Convert.ToInt32(Sp.Transpak.Common.SSOClientHelper.Read(&quot;Sp.Transpak&quot;, &quot;TranspakDelayinMS&quot;)));" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Delay_SSO" />
                        <om:Property Name="Signal" Value="True" />
                    </om:Element>
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="d70e85ac-7f03-4685-ac09-40db297eec6d" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="28.1" HigherBound="30.1">
                <om:Property Name="PortModifier" Value="Implements" />
                <om:Property Name="Orientation" Value="Left" />
                <om:Property Name="PortIndex" Value="-1" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="Sp.Transpak.Orchestrations.PortType_RcvTranspakLHDNSentInvTPS" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Port_RcvTranspakLHDNSentInvTPS" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="LogicalBindingAttribute" OID="94104387-c93d-4107-9918-827c725004c3" ParentLink="PortDeclaration_CLRAttribute" LowerBound="28.1" HigherBound="29.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="a7f86d70-a9e7-4cbc-918b-c35d9eb753d1" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="30.1" HigherBound="32.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="165" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="Sp.Transpak.Orchestrations.PortType_SndTranspakTPSInvRespErrorEmail" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Port_SndTranspakTPSInvRespErrorEmail" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="PhysicalBindingAttribute" OID="9a7accef-cb7a-4f1e-aecc-4acf48b6fbd0" ParentLink="PortDeclaration_CLRAttribute" LowerBound="30.1" HigherBound="31.1">
                    <om:Property Name="InPipeline" Value="Microsoft.BizTalk.DefaultPipelines.XMLReceive" />
                    <om:Property Name="OutPipeline" Value="Microsoft.BizTalk.DefaultPipelines.PassThruTransmit" />
                    <om:Property Name="TransportType" Value="HTTP" />
                    <om:Property Name="URI" Value="http://tempURI" />
                    <om:Property Name="IsDynamic" Value="True" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="803a1cfd-531e-4aaa-8c8d-0e6af17fceda" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="32.1" HigherBound="34.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="43" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="Sp.Transpak.Orchestrations.PortType_SndRcvTranspakInvStatusPeppolDB" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Port_SndRcvTranspakInvStatusPeppolDB" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="LogicalBindingAttribute" OID="badd19d7-e5e7-4484-95a6-9e414bf7949a" ParentLink="PortDeclaration_CLRAttribute" LowerBound="32.1" HigherBound="33.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="7164ac6f-7797-4f76-bbef-b2e275980c04" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="34.1" HigherBound="36.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="91" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="Sp.Transpak.Orchestrations.PortType_SndRcvTranspakInvStatusUpd" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Port_SndRcvTranspakInvStatusUpd" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="LogicalBindingAttribute" OID="44ade194-57bb-4e82-94c5-33f5e7e3276b" ParentLink="PortDeclaration_CLRAttribute" LowerBound="34.1" HigherBound="35.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="a6fae1f8-450a-48d5-bffa-e211f87bed9f" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="36.1" HigherBound="38.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="112" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="Sp.Transpak.Orchestrations.PortType_SndTranspakInvRespFFTPS" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Port_SndTranspakInvRespFFTPS" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="LogicalBindingAttribute" OID="f78f41a7-5de2-49de-9d9a-f56b3694c180" ParentLink="PortDeclaration_CLRAttribute" LowerBound="36.1" HigherBound="37.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="14fbae1c-ce89-4b75-894d-06301b0c9e27" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="38.1" HigherBound="40.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="127" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="Sp.Transpak.Orchestrations.PortType_SndTranspakErrorLogs" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Port_SndTranspakErrorLogs" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="LogicalBindingAttribute" OID="710e44fa-cf47-4c0a-b3d7-85f2e08f96e0" ParentLink="PortDeclaration_CLRAttribute" LowerBound="38.1" HigherBound="39.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
    </om:Element>
</om:MetaModel>
#endif // __DESIGNER_DATA
[Microsoft.XLANGs.BaseTypes.BPELExportable(false)]
module Sp.Transpak.Orchestrations
{
    internal porttype PortType_RcvTranspakLHDNSentInvTPS
    {
        oneway Operation_1
        {
            Sp.Transpak.Schemas.uspLHDNSentTPS_TypedPolling_InterfaceLHDNSentTranspakInvoicesTPS.TypedPolling
        };
    };
    internal porttype PortType_SndTranspakTPSInvRespErrorEmail
    {
        oneway Operation_1
        {
            msgMultiErrorEmail
        };
    };
    internal porttype PortType_SndTranspakInvRespFFTPS
    {
        oneway Operation_1
        {
            Sp.Transpak.Schemas.TranspakInvoiceResponse
        };
    };
    [Microsoft.XLANGs.BaseTypes.BPELExportable(false)]
    internal service Process_TranspakInvResponse_TPS
    {
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port implements PortType_RcvTranspakLHDNSentInvTPS Port_RcvTranspakLHDNSentInvTPS;
        [Microsoft.XLANGs.BaseTypes.PhysicalBinding(typeof(Microsoft.BizTalk.DefaultPipelines.PassThruTransmit))]
        port uses dynamic PortType_SndTranspakTPSInvRespErrorEmail Port_SndTranspakTPSInvRespErrorEmail;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses PortType_SndRcvTranspakInvStatusPeppolDB Port_SndRcvTranspakInvStatusPeppolDB;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses PortType_SndRcvTranspakInvStatusUpd Port_SndRcvTranspakInvStatusUpd;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses PortType_SndTranspakInvRespFFTPS Port_SndTranspakInvRespFFTPS;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses PortType_SndTranspakErrorLogs Port_SndTranspakErrorLogs;
        message Sp.Transpak.Schemas.uspInvoiceStatusupd_TypedProcedure_dbo.InterfaceTranspakInvStatusUpdResponse msgUpdStatusResp;
        message Sp.Transpak.Schemas.uspInvoiceStatusupd_TypedProcedure_dbo.InterfaceTranspakInvStatusUpd msgUpdStatusReq;
        message Sp.Transpak.Schemas.uspLHDNSentTPS_TypedPolling_InterfaceLHDNSentTranspakInvoicesTPS.TypedPollingResultSet0 msgSingleInvoice;
        message Sp.Transpak.Schemas.TranspakInvoiceResponse msgResponseFF;
        message Sp.Transpak.Schemas.uspLHDNSentTPS_TypedPolling_InterfaceLHDNSentTranspakInvoicesTPS.TypedPolling msgPollInvoices;
        message Sp.Transpak.Schemas.uspTranspakInvStatusPeppolDb_TypedProcedure_dbo.InterfaceTranspakInvStatusResponse msgLHDNInvStatusResp;
        message Sp.Transpak.Schemas.uspTranspakInvStatusPeppolDb_TypedProcedure_dbo.InterfaceTranspakInvStatus msgLHDNInvStatus;
        message msgMultiErrorLogs msgErrorLogs;
        message msgMultiErrorEmail msgErrorEmail;
        System.String varValidationDateTime;
        System.String varUUID;
        System.Xml.XmlDocument varTempXML;
        System.String varSubmissionID;
        System.String varStatusMsg;
        System.String varStatusCode;
        System.String varLoopItem;
        System.Int32 varLoopCounter;
        System.String varLongId;
        System.String varInvoiceNo;
        System.String varInterfaceStatus;
        System.String varFileName;
        System.String varExceptionmsg;
        System.Text.StringBuilder varEmailBody;
        System.String varDocId;
        System.Int32 varDocCount;
        body ()
        {
            [Microsoft.XLANGs.BaseTypes.DesignerPosition("bca99a99-3c2b-48da-b747-3353d09415c9")]
            activate receive (Port_RcvTranspakLHDNSentInvTPS.Operation_1, msgPollInvoices);
            varValidationDateTime = "";
            varUUID = "";
            varTempXML = new System.Xml.XmlDocument();
            varSubmissionID = "";
            varStatusMsg = "";
            varStatusCode = "";
            varLoopItem = "";
            varLoopCounter = 0;
            varLongId = "";
            varInvoiceNo = "";
            varInterfaceStatus = "";
            varFileName = "";
            varExceptionmsg = "";
            varEmailBody = new System.Text.StringBuilder();
            varDocId = "";
            varDocCount = 0;
            [Microsoft.XLANGs.BaseTypes.DesignerPosition("5195b904-c8e4-4752-a4ad-958e602a5e24")]
            System.Diagnostics.EventLog.WriteEntry("Transpak_TPS Invoice Response Process Start","Transpak_TPS Invoice Response Process Started");
            varDocCount = xpath(msgPollInvoices,"count(/*[local-name()='TypedPolling' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/TypedPolling/InterfaceLHDNSentTranspakInvoicesTPS']/*[local-name()='TypedPollingResultSet0' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/TypedPolling/InterfaceLHDNSentTranspakInvoicesTPS']/*[local-name()='TypedPollingResultSet0' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/TypedPolling/InterfaceLHDNSentTranspakInvoicesTPS']/*[local-name()='DocumentID' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/TypedPolling/InterfaceLHDNSentTranspakInvoicesTPS'])");
            System.Diagnostics.EventLog.WriteEntry("Transpak_TPS Inv Resp Doc Count",varDocCount.ToString());
            [Microsoft.XLANGs.BaseTypes.DesignerPosition("c75432fb-cb90-4d07-a6b2-8f3fb5bc1b69")]
            while (varLoopCounter < varDocCount)
            {
                [Microsoft.XLANGs.BaseTypes.DesignerPosition("71669da5-df2a-4e07-96e5-b01957890885")]
                scope
                {
                    body
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("d753eb33-2698-4597-87ff-64e2afb56c68")]
                        varLoopCounter = varLoopCounter + 1;
                        varLoopItem = varLoopCounter.ToString();
                        
                        varUUID = "";
                        varLongId = "";
                        varStatusCode = "";
                        varStatusMsg = "";
                        varValidationDateTime = "";
                        varInterfaceStatus = "";
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("7db8b488-f67c-40e7-98f5-dc1bd5a8905c")]
                        construct msgSingleInvoice
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("6c42124e-d801-46e9-a4ef-cb77898d3825")]
                            msgSingleInvoice = xpath(msgPollInvoices, "/*[local-name()='TypedPolling' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/TypedPolling/InterfaceLHDNSentTranspakInvoicesTPS']/*[local-name()='TypedPollingResultSet0' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/TypedPolling/InterfaceLHDNSentTranspakInvoicesTPS']/*[local-name()='TypedPollingResultSet0' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/TypedPolling/InterfaceLHDNSentTranspakInvoicesTPS']["+ varLoopItem +"]" );
                            varDocId = msgSingleInvoice.DocumentID;
                            varInvoiceNo = msgSingleInvoice.DocumentNumber;
                            varSubmissionID = msgSingleInvoice.SubmissionID;
                            varInterfaceStatus = msgSingleInvoice.InterfaceStatus;
                            varStatusMsg = msgSingleInvoice.InterfaceMessage;
                            varValidationDateTime = msgSingleInvoice.InterfaceDate;
                            
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("e8557692-3243-44a4-8c43-c1214e09e22a")]
                        
                        if(System.Convert.ToString(Sp.Transpak.Common.SSOClientHelper.Read("Sp.Transpak", "ShowTranspakAdminLogs")) == "Yes")
                        {
                            System.Diagnostics.EventLog.WriteEntry("varDocId",varDocId);
                            System.Diagnostics.EventLog.WriteEntry("InvoiceNo",varInvoiceNo);
                            System.Diagnostics.EventLog.WriteEntry("varInterfaceStatus",varInterfaceStatus);
                            System.Diagnostics.EventLog.WriteEntry("varStatusMsg",varStatusMsg);
                            varTempXML = new System.Xml.XmlDocument();
                            varTempXML = msgSingleInvoice;
                            if(varTempXML.OuterXml.Length < 30000)
                            {
                                System.Diagnostics.EventLog.WriteEntry("msgSingleInvoice",varTempXML.OuterXml);
                            }
                            else
                            {
                                System.Diagnostics.EventLog.WriteEntry("msgSingleInvoice",varTempXML.OuterXml.Substring(0,29500));
                            }
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("1d9c6303-15c4-4254-bd4a-13288b8e22e2")]
                        if (varInterfaceStatus == "LHDNSent")
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("367c22ea-5d4c-4f23-b24c-af416cbf191d")]
                            construct msgLHDNInvStatus
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("134fda47-e97a-4840-aef4-03b1931b2111")]
                                varTempXML = new System.Xml.XmlDocument();
                                varTempXML.LoadXml("<ns0:InterfaceTranspakInvStatus xmlns:ns0='http://schemas.microsoft.com/Sql/2008/05/TypedProcedures/dbo'><ns0:DocumentID>" + varSubmissionID + "</ns0:DocumentID><ns0:InvoiceNumber>" + varInvoiceNo + "</ns0:InvoiceNumber></ns0:InterfaceTranspakInvStatus>");
                                msgLHDNInvStatus = varTempXML;
                            }
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("68ef7f3b-61ec-4fe6-9bc8-c6a45dfb4664")]
                            
                            if(System.Convert.ToString(Sp.Transpak.Common.SSOClientHelper.Read("Sp.Transpak", "ShowTranspakAdminLogs")) == "Yes")
                            {
                                varTempXML = new System.Xml.XmlDocument();
                                varTempXML = msgLHDNInvStatus;
                                if(varTempXML.OuterXml.Length < 30000)
                                {
                                    System.Diagnostics.EventLog.WriteEntry("msgLHDNInvStatus",varTempXML.OuterXml);
                                }
                                else
                                {
                                    System.Diagnostics.EventLog.WriteEntry("msgLHDNInvStatus",varTempXML.OuterXml.Substring(1,29500));
                                }
                            }
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("5c780aaa-11ae-41cc-9a1b-48e663bc4ac1")]
                            send (Port_SndRcvTranspakInvStatusPeppolDB.Operation_1, msgLHDNInvStatus);
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("6c7634d3-d03d-4cfc-8c8f-426179a9d7ba")]
                            receive (Port_SndRcvTranspakInvStatusPeppolDB.Operation_1, msgLHDNInvStatusResp);
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("db7e47c6-6e84-4c44-997b-bf45bfe0e32a")]
                            if(System.Convert.ToString(Sp.Transpak.Common.SSOClientHelper.Read("Sp.Transpak", "ShowTranspakAdminLogs")) == "Yes")
                            {
                                varTempXML = new System.Xml.XmlDocument();
                                varTempXML = msgLHDNInvStatusResp;
                                if(varTempXML.OuterXml.Length < 30000)
                                {
                                    System.Diagnostics.EventLog.WriteEntry("msgLHDNInvStatusResp",varTempXML.OuterXml);
                                }
                                else
                                {
                                    System.Diagnostics.EventLog.WriteEntry("msgLHDNInvStatusResp",varTempXML.OuterXml.Substring(0,29500));
                                }
                            }
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("9d66e640-8f5d-469b-9306-5ea04ca5a373")]
                            varUUID = xpath(msgLHDNInvStatusResp,"string(/*[local-name()='InterfaceTranspakInvStatusResponse' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/TypedProcedures/dbo']/*[local-name()='StoredProcedureResultSet0' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/TypedProcedures/dbo']/*[local-name()='StoredProcedureResultSet0' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/ProceduresResultSets/dbo/InterfaceTranspakInvStatus']/*[local-name()='UUID' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/ProceduresResultSets/dbo/InterfaceTranspakInvStatus']/text())");
                            varLongId = xpath(msgLHDNInvStatusResp,"string(/*[local-name()='InterfaceTranspakInvStatusResponse' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/TypedProcedures/dbo']/*[local-name()='StoredProcedureResultSet0' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/TypedProcedures/dbo']/*[local-name()='StoredProcedureResultSet0' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/ProceduresResultSets/dbo/InterfaceTranspakInvStatus']/*[local-name()='LongId' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/ProceduresResultSets/dbo/InterfaceTranspakInvStatus']/text())");
                            varStatusCode = xpath(msgLHDNInvStatusResp,"string(/*[local-name()='InterfaceTranspakInvStatusResponse' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/TypedProcedures/dbo']/*[local-name()='StoredProcedureResultSet0' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/TypedProcedures/dbo']/*[local-name()='StoredProcedureResultSet0' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/ProceduresResultSets/dbo/InterfaceTranspakInvStatus']/*[local-name()='Status' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/ProceduresResultSets/dbo/InterfaceTranspakInvStatus']/text())");
                            varStatusMsg = xpath(msgLHDNInvStatusResp,"string(/*[local-name()='InterfaceTranspakInvStatusResponse' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/TypedProcedures/dbo']/*[local-name()='StoredProcedureResultSet0' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/TypedProcedures/dbo']/*[local-name()='StoredProcedureResultSet0' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/ProceduresResultSets/dbo/InterfaceTranspakInvStatus']/*[local-name()='Message' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/ProceduresResultSets/dbo/InterfaceTranspakInvStatus']/text())");
                            varValidationDateTime = xpath(msgLHDNInvStatusResp,"string(/*[local-name()='InterfaceTranspakInvStatusResponse' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/TypedProcedures/dbo']/*[local-name()='StoredProcedureResultSet0' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/TypedProcedures/dbo']/*[local-name()='StoredProcedureResultSet0' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/ProceduresResultSets/dbo/InterfaceTranspakInvStatus']/*[local-name()='ValidationDateTime' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/ProceduresResultSets/dbo/InterfaceTranspakInvStatus']/text())");
                            varInterfaceStatus = xpath(msgLHDNInvStatusResp,"string(/*[local-name()='InterfaceTranspakInvStatusResponse' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/TypedProcedures/dbo']/*[local-name()='StoredProcedureResultSet0' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/TypedProcedures/dbo']/*[local-name()='StoredProcedureResultSet0' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/ProceduresResultSets/dbo/InterfaceTranspakInvStatus']/*[local-name()='InterfaceStatus' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/ProceduresResultSets/dbo/InterfaceTranspakInvStatus']/text())");
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("e0424fc6-b1e6-4e87-a47f-788ebcd72934")]
                            if (varStatusCode == "")
                            {
                            }
                            else 
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("a0ae43b4-fe1b-499c-b5b8-b5e5c5241f46")]
                                construct msgResponseFF
                                {
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("c384f277-641c-4609-84d0-c7e91077a3b3")]
                                    varTempXML = new System.Xml.XmlDocument();
                                    varTempXML.LoadXml("<InvoiceResponse><InvoiceNumber>" + varInvoiceNo + "</InvoiceNumber><UUID>" + varUUID + "</UUID><LongID>" + varLongId + "</LongID><StatusCode>" + varStatusCode + "</StatusCode><StatusMessage>" + varStatusMsg + "</StatusMessage><ValidationDateTime>" + varValidationDateTime + "</ValidationDateTime></InvoiceResponse>");
                                    msgResponseFF = varTempXML;
                                    varFileName = "TPS_IR_" + varInvoiceNo + "_" + System.DateTime.Now.ToString("yyyyMMddHHmmssfff") + ".xml";
                                    msgResponseFF(FILE.ReceivedFileName) = varFileName;
                                }
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("7100c706-1d86-4fe3-886b-eee70cd121ef")]
                                
                                if(System.Convert.ToString(Sp.Transpak.Common.SSOClientHelper.Read("Sp.Transpak", "ShowTranspakAdminLogs")) == "Yes")
                                {
                                    varTempXML = new System.Xml.XmlDocument();
                                    varTempXML = msgResponseFF;
                                    if(varTempXML.OuterXml.Length < 30000)
                                    {
                                        System.Diagnostics.EventLog.WriteEntry("msgResponseFF",varTempXML.OuterXml);
                                    }
                                    else
                                    {
                                        System.Diagnostics.EventLog.WriteEntry("msgResponseFF",varTempXML.OuterXml.Substring(0,29500));
                                    }
                                }
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("2b765f08-2c7e-4a6f-92bd-26085ce55e75")]
                                construct msgUpdStatusReq
                                {
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("94c0c460-734b-4fa5-acff-9d39220b3e80")]
                                    varTempXML = new System.Xml.XmlDocument();
                                    varTempXML.LoadXml("<ns0:InterfaceTranspakInvStatusUpd xmlns:ns0='http://schemas.microsoft.com/Sql/2008/05/TypedProcedures/dbo'><ns0:DocumentID>" + varDocId + "</ns0:DocumentID><ns0:StatusType>LHDN</ns0:StatusType><ns0:Status>" + varInterfaceStatus + "</ns0:Status><ns0:StatusMessage>" + varStatusMsg + "</ns0:StatusMessage><ns0:StatusDateTime>" + varValidationDateTime + "</ns0:StatusDateTime><ns0:PeppolInvoiceXMLPath>-</ns0:PeppolInvoiceXMLPath></ns0:InterfaceTranspakInvStatusUpd>");
                                    msgUpdStatusReq = varTempXML;
                                }
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("1ce78d6e-e024-4366-957c-e08fc07ace42")]
                                
                                if(System.Convert.ToString(Sp.Transpak.Common.SSOClientHelper.Read("Sp.Transpak", "ShowTranspakAdminLogs")) == "Yes")
                                {
                                    varTempXML = new System.Xml.XmlDocument();
                                    varTempXML = msgUpdStatusReq;
                                    if(varTempXML.OuterXml.Length < 30000)
                                    {
                                        System.Diagnostics.EventLog.WriteEntry("msgInvStatusUpdReq",varTempXML.OuterXml);
                                    }
                                    else
                                    {
                                        System.Diagnostics.EventLog.WriteEntry("msgInvStatusUpdReq",varTempXML.OuterXml.Substring(1,29500));
                                    }
                                }
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("e7c5fbd8-11bb-4460-b2c7-88c6c15234d7")]
                                send (Port_SndRcvTranspakInvStatusUpd.Operation_1, msgUpdStatusReq);
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("e05a1904-7abc-4f1d-bf1b-fa23fe8f278f")]
                                receive (Port_SndRcvTranspakInvStatusUpd.Operation_1, msgUpdStatusResp);
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("932fb5bd-f3ef-4b86-9390-492717547b17")]
                                
                                if(System.Convert.ToString(Sp.Transpak.Common.SSOClientHelper.Read("Sp.Transpak", "ShowTranspakAdminLogs")) == "Yes")
                                {
                                    varTempXML = new System.Xml.XmlDocument();
                                    varTempXML = msgUpdStatusResp;
                                    if(varTempXML.OuterXml.Length < 30000)
                                    {
                                        System.Diagnostics.EventLog.WriteEntry("msgUpdStatusResp",varTempXML.OuterXml);
                                    }
                                    else
                                    {
                                        System.Diagnostics.EventLog.WriteEntry("msgUpdStatusResp",varTempXML.OuterXml.Substring(0,29500));
                                    }
                                }
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("f999dc77-ad9c-40d4-8895-9dafc4ddf84d")]
                                send (Port_SndTranspakInvRespFFTPS.Operation_1, msgResponseFF);
                            }
                        }
                        else 
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("2a3f58dc-0767-4da5-9a82-996fbffc83cb")]
                            construct msgResponseFF
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("7bfcd48f-2e80-4607-98e0-e78921d7febf")]
                                varTempXML = new System.Xml.XmlDocument();
                                varTempXML.LoadXml("<InvoiceResponse><InvoiceNumber>" + varInvoiceNo + "</InvoiceNumber><UUID>-</UUID><LongID>-</LongID><StatusCode>" + varInterfaceStatus + "</StatusCode><StatusMessage>" + varStatusMsg + "</StatusMessage><ValidationDateTime>" + varValidationDateTime + "</ValidationDateTime></InvoiceResponse>");
                                msgResponseFF = varTempXML;
                                varFileName = "TPS_IR_" + varInvoiceNo + "_" + System.DateTime.Now.ToString("yyyyMMddHHmmssfff") + ".xml";
                                msgResponseFF(FILE.ReceivedFileName) = varFileName;
                            }
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("9de98355-9eeb-4559-abe0-90a1e8c7ebb3")]
                            construct msgUpdStatusReq
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("ef32fbd7-74f0-4f85-acb3-7168b0ff717b")]
                                varTempXML = new System.Xml.XmlDocument();
                                varTempXML.LoadXml("<ns0:InterfaceTranspakInvStatusUpd xmlns:ns0='http://schemas.microsoft.com/Sql/2008/05/TypedProcedures/dbo'><ns0:DocumentID>" + varDocId + "</ns0:DocumentID><ns0:StatusType>LHDN</ns0:StatusType><ns0:Status>" + varInterfaceStatus + "</ns0:Status><ns0:StatusMessage>" + varStatusMsg + "</ns0:StatusMessage><ns0:StatusDateTime>" + varValidationDateTime + "</ns0:StatusDateTime><ns0:PeppolInvoiceXMLPath>-</ns0:PeppolInvoiceXMLPath></ns0:InterfaceTranspakInvStatusUpd>");
                                msgUpdStatusReq = varTempXML;
                            }
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("f26ce7cc-18b4-4c34-b549-0e1a58ad9ca8")]
                            send (Port_SndRcvTranspakInvStatusUpd.Operation_1, msgUpdStatusReq);
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("003d44a3-ca99-425f-98c0-ac51d624d22e")]
                            receive (Port_SndRcvTranspakInvStatusUpd.Operation_1, msgUpdStatusResp);
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("6e55a3e2-546a-41db-886f-db9dfe926a18")]
                            send (Port_SndTranspakInvRespFFTPS.Operation_1, msgResponseFF);
                        }
                    }
                    exceptions
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("ff283a19-61ba-4795-9884-3e85e321f06d")]
                        catch (System.Exception ex)
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("f8eb2fec-d5ee-4c88-af5f-bd308374e321")]
                            System.Diagnostics.EventLog.WriteEntry("TranspakTPS_APIUpdateException",ex.Message);
                            varExceptionmsg = ex.Message;
                            varExceptionmsg = varExceptionmsg.Replace("&","&amp;");
                            varExceptionmsg = varExceptionmsg.Replace("'","''");
                            varExceptionmsg = varExceptionmsg.Replace("<","&lt;");
                            varExceptionmsg = varExceptionmsg.Replace(">","&gt;");
                            if(varExceptionmsg.Length > 1000)
                            {
                                varExceptionmsg = varExceptionmsg.Substring(0,999);
                            }
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("5c4e04a0-ea8e-4534-b993-c1c92af8815d")]
                            construct msgErrorLogs
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("5cff6c79-638a-446d-98ea-6fe7a1820baf")]
                                varTempXML = new System.Xml.XmlDocument();
                                varTempXML.LoadXml("<ns0:InterfaceErrorLogs xmlns:ns0='http://schemas.microsoft.com/Sql/2008/05/TypedProcedures/dbo'><ns0:HubID>TSP</ns0:HubID><ns0:DocumentID>" + varDocId + "</ns0:DocumentID><ns0:DocumentType>TSPInvoiceResponse</ns0:DocumentType><ns0:DocumentNumber>" + varInvoiceNo + "</ns0:DocumentNumber><ns0:ModuleName>Process_TranspakInvResponse_TSP</ns0:ModuleName><ns0:ExceptionType>" + ex.Source + "</ns0:ExceptionType><ns0:ErrorMessage>" + varExceptionmsg + "</ns0:ErrorMessage><ns0:VendorCode>-</ns0:VendorCode><ns0:DocumentPath>-</ns0:DocumentPath></ns0:InterfaceErrorLogs>");
                                msgErrorLogs.Body = varTempXML;
                                
                            }
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("7f67b307-8bdf-48c2-9aed-ccd434dd3abd")]
                            send (Port_SndTranspakErrorLogs.Operation_1, msgErrorLogs);
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("ba0bfa96-c553-4890-817f-49095bb92965")]
                            construct msgErrorEmail
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("ee060a84-694e-4f00-a608-7863bc9ca947")]
                                System.Diagnostics.EventLog.WriteEntry("TranspakTPSInvRespException",ex.Message);
                                
                                varEmailBody = new System.Text.StringBuilder();
                                varEmailBody.AppendLine("<html><body>");
                                varEmailBody.AppendLine("<p>Transpak_TPS Invoice Resp Status update failed while Updating in SESAMi.</p>");
                                varEmailBody.AppendLine("<p><b><u>Error details:</u></b></p><p>");
                                varEmailBody.AppendLine("<b>Application Name</b> : <i>Sp.Transpak</i><br/>");
                                varEmailBody.AppendLine("<b>Process Name</b> : <i>Process_TranspakInvResponse_TSP</i><br/>");
                                varEmailBody.AppendLine("<b>DocId</b> : <i>" + varDocId  + "</i><br/>");
                                varEmailBody.AppendLine("<b>Failure Code</b> : " + ex.Source + "<br/>");
                                varEmailBody.AppendLine("<b>Error Description</b> : <i>" + ex.Message + "</i><br/>");
                                varEmailBody.AppendLine("</body></html>");
                                msgErrorEmail.Body = new Sp.Transpak.Common.RawString(varEmailBody.ToString());
                                Sp.Transpak.Common.SMTPUtils.SetContentType(msgErrorEmail.Body,"text/html");
                                Port_SndTranspakTPSInvRespErrorEmail(Microsoft.XLANGs.BaseTypes.Address) = Sp.Transpak.Common.SSOClientHelper.Read("Sp.Transpak", "SMTPTo");
                                
                                msgErrorEmail(SMTP.From) = Sp.Transpak.Common.SSOClientHelper.Read("Sp.Transpak", "SMTPFrom");
                                
                                msgErrorEmail(SMTP.Subject) = "Transpak TPS Invoice Resp status failed while updating status for Invoice: " + varInvoiceNo;
                                
                                msgErrorEmail(SMTP.EmailBodyFileCharset) = "UTF-8";
                                msgErrorEmail(SMTP.CC) = Sp.Transpak.Common.SSOClientHelper.Read("Sp.Transpak", "SMTPCCopy");
                                msgErrorEmail(SMTP.SMTPHost)= Sp.Transpak.Common.SSOClientHelper.Read("Sp.Transpak", "SMTPHost");
                            }
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("279b71da-fff2-4207-b3b0-16cb3990baf3")]
                            send (Port_SndTranspakTPSInvRespErrorEmail.Operation_1, msgErrorEmail);
                        }
                    }
                }
                [Microsoft.XLANGs.BaseTypes.DesignerPosition("4a236543-822d-4742-ac75-3526020e43ed")]
                delay new System.TimeSpan(0,0,0,0,System.Convert.ToInt32(Sp.Transpak.Common.SSOClientHelper.Read("Sp.Transpak", "TranspakDelayinMS")));
            }
        }
    }
}

