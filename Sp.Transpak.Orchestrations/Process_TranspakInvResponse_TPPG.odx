#if __DESIGNER_DATA
#error Do not define __DESIGNER_DATA.
<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<om:MetaModel MajorVersion="1" MinorVersion="3" Core="2b131234-7959-458d-834f-2dc0769ce683" ScheduleModel="66366196-361d-448d-976f-cab5e87496d2" xmlns:om="http://schemas.microsoft.com/BizTalk/2003/DesignerData">
    <om:Element Type="Module" OID="aca591eb-c7f6-4ce6-99a4-a8cdb3cc0f7a" LowerBound="1.1" HigherBound="354.1">
        <om:Property Name="ReportToAnalyst" Value="True" />
        <om:Property Name="Name" Value="Sp.Transpak.Orchestrations" />
        <om:Property Name="Signal" Value="False" />
        <om:Element Type="PortType" OID="1fa75a14-ce9c-4d24-9993-2766be381dbd" ParentLink="Module_PortType" LowerBound="4.1" HigherBound="11.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_RcvTranspakLHDNSentInvTPPG" />
            <om:Property Name="Signal" Value="True" />
            <om:Element Type="OperationDeclaration" OID="052efe1d-cd63-4fbc-a368-f61c6ed68518" ParentLink="PortType_OperationDeclaration" LowerBound="6.1" HigherBound="10.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="5bd2665c-d399-4f2d-8c02-b5bac00242e7" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="8.13" HigherBound="8.113">
                    <om:Property Name="Ref" Value="Sp.Transpak.Schemas.uspLHDNSentTPGG_TypedPolling_InterfaceLHDNSentTranspakInvoices_TPGG.TypedPolling" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="b4896f18-5a10-42f2-8d34-fc50925add28" ParentLink="Module_PortType" LowerBound="11.1" HigherBound="18.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_SndTranspakInvRespFFTPPG" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="2db41c8a-7650-49a3-a3ac-818427f15739" ParentLink="PortType_OperationDeclaration" LowerBound="13.1" HigherBound="17.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="0a4a03d8-c083-46fa-9240-ff87947ea0fa" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="15.13" HigherBound="15.56">
                    <om:Property Name="Ref" Value="Sp.Transpak.Schemas.TranspakInvoiceResponse" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="ServiceDeclaration" OID="f5d5b8e0-01fc-4899-b5b5-9efa0dd11c56" ParentLink="Module_ServiceDeclaration" LowerBound="18.1" HigherBound="353.1">
            <om:Property Name="InitializedTransactionType" Value="False" />
            <om:Property Name="IsInvokable" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="Process_TranspakInvResponse_TPPG" />
            <om:Property Name="Signal" Value="True" />
            <om:Element Type="VariableDeclaration" OID="36499194-7be9-4f3a-a7b8-809c2f3d6cf2" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="42.1" HigherBound="43.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varValidationDateTime" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="2b182b1b-e45f-496b-8a10-6b0bf8cd15f0" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="43.1" HigherBound="44.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varUUID" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="f534eb70-8677-4d88-960c-68088ad960bb" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="44.1" HigherBound="45.1">
                <om:Property Name="UseDefaultConstructor" Value="True" />
                <om:Property Name="Type" Value="System.Xml.XmlDocument" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varTempXML" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="20ac913f-170d-4cd8-b3dc-90e2d8754290" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="45.1" HigherBound="46.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varSubmissionID" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="9205fb2d-a6f2-47b6-ba77-ba49dcfa0ba3" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="46.1" HigherBound="47.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varStatusMsg" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="c2a663b9-7d4c-4598-9d02-315152d800c3" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="47.1" HigherBound="48.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varStatusCode" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="178e69e3-7005-4bb2-ab3f-b31363c24d7d" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="48.1" HigherBound="49.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varLoopItem" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="e8dbeee7-0732-44f0-95a0-8491c6aad8b4" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="49.1" HigherBound="50.1">
                <om:Property Name="InitialValue" Value="0" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Int32" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varLoopCounter" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="7e3b8778-88ab-44a5-9030-1b5479f81abd" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="50.1" HigherBound="51.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varLongId" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="fab5f0a6-c5a1-44a5-b525-96364b6ebdb1" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="51.1" HigherBound="52.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varInvoiceNo" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="f90bc451-7f57-4ed7-8974-60ffbbb0a450" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="52.1" HigherBound="53.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varInterfaceStatus" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="41c4c868-312a-4b83-b17b-d4354df0cbe7" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="53.1" HigherBound="54.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varFileName" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="5c1849ce-ab19-4324-ad52-dbcf87d880e7" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="54.1" HigherBound="55.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varExceptionmsg" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="872c19ca-05c9-44ed-a3dc-e8ec71eb7771" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="55.1" HigherBound="56.1">
                <om:Property Name="UseDefaultConstructor" Value="True" />
                <om:Property Name="Type" Value="System.Text.StringBuilder" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varEmailBody" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="b607b4e1-bd8a-407b-9ffb-c865c89b08dd" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="56.1" HigherBound="57.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varDocId" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="6f6bf3de-7c43-427a-9bb5-99a737c30ee7" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="57.1" HigherBound="58.1">
                <om:Property Name="InitialValue" Value="0" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Int32" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varDocCount" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="fe31fc37-bc70-4243-a8cd-e9d190806132" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="33.1" HigherBound="34.1">
                <om:Property Name="Type" Value="Sp.Transpak.Schemas.uspInvoiceStatusupd_TypedProcedure_dbo.InterfaceTranspakInvStatusUpdResponse" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="msgUpdStatusResp" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="536f376c-fbb3-434d-98b0-0e7f4e687cb7" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="34.1" HigherBound="35.1">
                <om:Property Name="Type" Value="Sp.Transpak.Schemas.uspInvoiceStatusupd_TypedProcedure_dbo.InterfaceTranspakInvStatusUpd" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="msgUpdStatusReq" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="6ee5fdc1-6207-40ed-b01a-fe43a7d6fa96" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="35.1" HigherBound="36.1">
                <om:Property Name="Type" Value="Sp.Transpak.Schemas.uspLHDNSentTPGG_TypedPolling_InterfaceLHDNSentTranspakInvoices_TPGG.TypedPollingResultSet0" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="msgSingleInvoice" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="08f189d1-8f54-44e1-831d-cb0f660b2c3f" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="36.1" HigherBound="37.1">
                <om:Property Name="Type" Value="Sp.Transpak.Schemas.TranspakInvoiceResponse" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="msgResponseFF" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="dad886c8-5805-4164-af35-e0f9fcec210b" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="37.1" HigherBound="38.1">
                <om:Property Name="Type" Value="Sp.Transpak.Schemas.uspLHDNSentTPGG_TypedPolling_InterfaceLHDNSentTranspakInvoices_TPGG.TypedPolling" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="msgPollInvoices" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="da1d0901-3241-40ec-a1e9-65e910a1120d" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="38.1" HigherBound="39.1">
                <om:Property Name="Type" Value="Sp.Transpak.Schemas.uspTranspakInvStatusPeppolDb_TypedProcedure_dbo.InterfaceTranspakInvStatusResponse" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="msgLHDNInvStatusResp" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="c17667b6-0586-4eaf-aea0-0a3cc362a9b8" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="39.1" HigherBound="40.1">
                <om:Property Name="Type" Value="Sp.Transpak.Schemas.uspTranspakInvStatusPeppolDb_TypedProcedure_dbo.InterfaceTranspakInvStatus" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="msgLHDNInvStatus" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="2a5723f9-f89c-4e8d-bc46-8894f4717253" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="40.1" HigherBound="41.1">
                <om:Property Name="Type" Value="Sp.Transpak.Orchestrations.msgMultiErrorLogs" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="msgErrorLogs" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="e553d218-4208-4bd1-a05c-c08b5ead3c32" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="41.1" HigherBound="42.1">
                <om:Property Name="Type" Value="Sp.Transpak.Orchestrations.msgMultiErrorEmail" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="msgErrorEmail" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="ServiceBody" OID="90b6ca4c-04f1-4677-9ec6-003d3b20a7ab" ParentLink="ServiceDeclaration_ServiceBody">
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="Receive" OID="c8dcf6d3-16e4-4738-b778-15cafc10e5d4" ParentLink="ServiceBody_Statement" LowerBound="60.1" HigherBound="78.1">
                    <om:Property Name="Activate" Value="True" />
                    <om:Property Name="PortName" Value="Port_RcvTranspakLHDNSentInvTPPG" />
                    <om:Property Name="MessageName" Value="msgPollInvoices" />
                    <om:Property Name="OperationName" Value="Operation_1" />
                    <om:Property Name="OperationMessageName" Value="Request" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Receive_1" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
                <om:Element Type="VariableAssignment" OID="5142c904-5921-44ee-bb39-e79b919364ec" ParentLink="ServiceBody_Statement" LowerBound="78.1" HigherBound="82.1">
                    <om:Property Name="Expression" Value="System.Diagnostics.EventLog.WriteEntry(&quot;Transpak_TPPG Invoice Response Process Start&quot;,&quot;Transpak_TPPG Invoice Response Process Started&quot;);&#xD;&#xA;varDocCount = xpath(msgPollInvoices,&quot;count(/*[local-name()='TypedPolling' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/TypedPolling/InterfaceLHDNSentTranspakInvoices_TPPG']/*[local-name()='TypedPollingResultSet0' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/TypedPolling/InterfaceLHDNSentTranspakInvoices_TPPG']/*[local-name()='TypedPollingResultSet0' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/TypedPolling/InterfaceLHDNSentTranspakInvoices_TPPG']/*[local-name()='DocumentID' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/TypedPolling/InterfaceLHDNSentTranspakInvoices_TPPG'])&quot;);&#xD;&#xA;System.Diagnostics.EventLog.WriteEntry(&quot;Transpak_TPPG Inv Resp Doc Count&quot;,varDocCount.ToString());&#xD;&#xA;" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Process_Start" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
                <om:Element Type="While" OID="b363c2d6-4408-4c9b-872f-b00b4fca3cbb" ParentLink="ServiceBody_Statement" LowerBound="82.1" HigherBound="349.1">
                    <om:Property Name="Expression" Value="varLoopCounter &lt; varDocCount" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Loop_DocumentIds" />
                    <om:Property Name="Signal" Value="True" />
                    <om:Element Type="Scope" OID="b73b33cd-3d2b-483f-9a3b-f4098fc314f3" ParentLink="ComplexStatement_Statement" LowerBound="85.1" HigherBound="346.1">
                        <om:Property Name="InitializedTransactionType" Value="True" />
                        <om:Property Name="IsSynchronized" Value="False" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Scope_PeppolXml" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="VariableAssignment" OID="61a1274e-3e98-45bf-a038-c691262e00f4" ParentLink="ComplexStatement_Statement" LowerBound="90.1" HigherBound="100.1">
                            <om:Property Name="Expression" Value="varLoopCounter = varLoopCounter + 1;&#xD;&#xA;varLoopItem = varLoopCounter.ToString();&#xD;&#xA;&#xD;&#xA;varUUID = &quot;&quot;;&#xD;&#xA;varLongId = &quot;&quot;;&#xD;&#xA;varStatusCode = &quot;&quot;;&#xD;&#xA;varStatusMsg = &quot;&quot;;&#xD;&#xA;varValidationDateTime = &quot;&quot;;&#xD;&#xA;varInterfaceStatus = &quot;&quot;;" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Incr_Counter" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                        <om:Element Type="Construct" OID="55ba6b5b-95ba-4b9a-b2de-e73361201391" ParentLink="ComplexStatement_Statement" LowerBound="100.1" HigherBound="113.1">
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Const_SingleDocId" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="MessageRef" OID="fd74bdea-3f26-4527-a22b-98db0e1afca7" ParentLink="Construct_MessageRef" LowerBound="101.35" HigherBound="101.51">
                                <om:Property Name="Ref" Value="msgSingleInvoice" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                            <om:Element Type="MessageAssignment" OID="2596617f-29b4-4775-8ee8-58cb3487e1e7" ParentLink="ComplexStatement_Statement" LowerBound="103.1" HigherBound="112.1">
                                <om:Property Name="Expression" Value="msgSingleInvoice = xpath(msgPollInvoices, &quot;/*[local-name()='TypedPolling' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/TypedPolling/InterfaceLHDNSentTranspakInvoices_TPPG']/*[local-name()='TypedPollingResultSet0' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/TypedPolling/InterfaceLHDNSentTranspakInvoices_TPPG']/*[local-name()='TypedPollingResultSet0' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/TypedPolling/InterfaceLHDNSentTranspakInvoices_TPPG'][&quot;+ varLoopItem +&quot;]&quot; );&#xD;&#xA;varDocId = msgSingleInvoice.DocumentID;&#xD;&#xA;varInvoiceNo = msgSingleInvoice.DocumentNumber;&#xD;&#xA;varSubmissionID = msgSingleInvoice.SubmissionID;&#xD;&#xA;varInterfaceStatus = msgSingleInvoice.InterfaceStatus;&#xD;&#xA;varStatusMsg = msgSingleInvoice.InterfaceMessage;&#xD;&#xA;varValidationDateTime = msgSingleInvoice.InterfaceDate;&#xD;&#xA;&#xD;&#xA;" />
                                <om:Property Name="ReportToAnalyst" Value="False" />
                                <om:Property Name="Name" Value="MsgAssign_InvoiceHeaderRequest" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                        </om:Element>
                        <om:Element Type="Decision" OID="9e0193be-6e7f-4fb3-ae4d-28eb0f2a87e3" ParentLink="ComplexStatement_Statement" LowerBound="113.1" HigherBound="285.1">
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Chk_LHDNSent" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="DecisionBranch" OID="2775c28c-84e3-46b9-b086-a8ac03358cc1" ParentLink="ReallyComplexStatement_Branch" LowerBound="114.25" HigherBound="227.1">
                                <om:Property Name="Expression" Value="varInterfaceStatus == &quot;LHDNSent&quot;" />
                                <om:Property Name="IsGhostBranch" Value="True" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="LHDNSent" />
                                <om:Property Name="Signal" Value="False" />
                                <om:Element Type="Construct" OID="1d3e3973-6340-4bcd-aeba-78f3fd41c469" ParentLink="ComplexStatement_Statement" LowerBound="116.1" HigherBound="124.1">
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Const_GetPeppolDBData" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="MessageAssignment" OID="b1326e2f-c5f7-4687-b671-fc7c2e053c23" ParentLink="ComplexStatement_Statement" LowerBound="119.1" HigherBound="123.1">
                                        <om:Property Name="Expression" Value="varTempXML = new System.Xml.XmlDocument();&#xD;&#xA;varTempXML.LoadXml(&quot;&lt;ns0:InterfaceTranspakInvStatus xmlns:ns0='http://schemas.microsoft.com/Sql/2008/05/TypedProcedures/dbo'&gt;&lt;ns0:DocumentID&gt;&quot; + varSubmissionID + &quot;&lt;/ns0:DocumentID&gt;&lt;ns0:InvoiceNumber&gt;&quot; + varInvoiceNo + &quot;&lt;/ns0:InvoiceNumber&gt;&lt;/ns0:InterfaceTranspakInvStatus&gt;&quot;);&#xD;&#xA;msgLHDNInvStatus = varTempXML;" />
                                        <om:Property Name="ReportToAnalyst" Value="False" />
                                        <om:Property Name="Name" Value="MessageAssignment_6" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                    <om:Element Type="MessageRef" OID="cab7c13d-5d9d-433c-a8c2-29b9a7c91120" ParentLink="Construct_MessageRef" LowerBound="117.39" HigherBound="117.55">
                                        <om:Property Name="Ref" Value="msgLHDNInvStatus" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="VariableAssignment" OID="8b086b23-51f3-4b16-aa29-9f4c9de87e3f" ParentLink="ComplexStatement_Statement" LowerBound="124.1" HigherBound="139.1">
                                    <om:Property Name="Expression" Value="&#xA;if(System.Convert.ToString(Sp.Transpak.Common.SSOClientHelper.Read(&quot;Sp.Transpak&quot;, &quot;ShowTranspakAdminLogs&quot;)) == &quot;Yes&quot;)&#xA;{&#xA;    varTempXML = new System.Xml.XmlDocument();&#xA;    varTempXML = msgLHDNInvStatus;&#xA;    if(varTempXML.OuterXml.Length &lt; 30000)&#xA;    {&#xA;        System.Diagnostics.EventLog.WriteEntry(&quot;msgLHDNInvStatus&quot;,varTempXML.OuterXml);&#xA;    }&#xA;    else&#xA;    {&#xA;        System.Diagnostics.EventLog.WriteEntry(&quot;msgLHDNInvStatus&quot;,varTempXML.OuterXml.Substring(1,29500));&#xA;    }&#xA;}" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="ShowLogs" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="Send" OID="3c94b701-35e6-4eaa-a7cf-7f65c92c6d05" ParentLink="ComplexStatement_Statement" LowerBound="139.1" HigherBound="141.1">
                                    <om:Property Name="PortName" Value="Port_SndRcvTranspakInvStatusPeppolDB" />
                                    <om:Property Name="MessageName" Value="msgLHDNInvStatus" />
                                    <om:Property Name="OperationName" Value="Operation_1" />
                                    <om:Property Name="OperationMessageName" Value="Request" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Send_2" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                                <om:Element Type="Receive" OID="a1d84674-08ec-42cc-90d9-a4845052995d" ParentLink="ComplexStatement_Statement" LowerBound="141.1" HigherBound="143.1">
                                    <om:Property Name="Activate" Value="False" />
                                    <om:Property Name="PortName" Value="Port_SndRcvTranspakInvStatusPeppolDB" />
                                    <om:Property Name="MessageName" Value="msgLHDNInvStatusResp" />
                                    <om:Property Name="OperationName" Value="Operation_1" />
                                    <om:Property Name="OperationMessageName" Value="Response" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Receive_2" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                                <om:Element Type="VariableAssignment" OID="7ebf084b-1a1e-4ec0-b980-526ed364330f" ParentLink="ComplexStatement_Statement" LowerBound="143.1" HigherBound="150.1">
                                    <om:Property Name="Expression" Value="varUUID = xpath(msgLHDNInvStatusResp,&quot;string(/*[local-name()='InterfaceTranspakInvStatusResponse' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/TypedProcedures/dbo']/*[local-name()='StoredProcedureResultSet0' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/TypedProcedures/dbo']/*[local-name()='StoredProcedureResultSet0' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/ProceduresResultSets/dbo/InterfaceTranspakInvStatus']/*[local-name()='UUID' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/ProceduresResultSets/dbo/InterfaceTranspakInvStatus']/text())&quot;);&#xD;&#xA;varLongId = xpath(msgLHDNInvStatusResp,&quot;string(/*[local-name()='InterfaceTranspakInvStatusResponse' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/TypedProcedures/dbo']/*[local-name()='StoredProcedureResultSet0' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/TypedProcedures/dbo']/*[local-name()='StoredProcedureResultSet0' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/ProceduresResultSets/dbo/InterfaceTranspakInvStatus']/*[local-name()='LongId' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/ProceduresResultSets/dbo/InterfaceTranspakInvStatus']/text())&quot;);&#xD;&#xA;varStatusCode = xpath(msgLHDNInvStatusResp,&quot;string(/*[local-name()='InterfaceTranspakInvStatusResponse' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/TypedProcedures/dbo']/*[local-name()='StoredProcedureResultSet0' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/TypedProcedures/dbo']/*[local-name()='StoredProcedureResultSet0' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/ProceduresResultSets/dbo/InterfaceTranspakInvStatus']/*[local-name()='Status' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/ProceduresResultSets/dbo/InterfaceTranspakInvStatus']/text())&quot;);&#xD;&#xA;varStatusMsg = xpath(msgLHDNInvStatusResp,&quot;string(/*[local-name()='InterfaceTranspakInvStatusResponse' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/TypedProcedures/dbo']/*[local-name()='StoredProcedureResultSet0' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/TypedProcedures/dbo']/*[local-name()='StoredProcedureResultSet0' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/ProceduresResultSets/dbo/InterfaceTranspakInvStatus']/*[local-name()='Message' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/ProceduresResultSets/dbo/InterfaceTranspakInvStatus']/text())&quot;);&#xD;&#xA;varValidationDateTime = xpath(msgLHDNInvStatusResp,&quot;string(/*[local-name()='InterfaceTranspakInvStatusResponse' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/TypedProcedures/dbo']/*[local-name()='StoredProcedureResultSet0' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/TypedProcedures/dbo']/*[local-name()='StoredProcedureResultSet0' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/ProceduresResultSets/dbo/InterfaceTranspakInvStatus']/*[local-name()='ValidationDateTime' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/ProceduresResultSets/dbo/InterfaceTranspakInvStatus']/text())&quot;);&#xD;&#xA;varInterfaceStatus = xpath(msgLHDNInvStatusResp,&quot;string(/*[local-name()='InterfaceTranspakInvStatusResponse' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/TypedProcedures/dbo']/*[local-name()='StoredProcedureResultSet0' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/TypedProcedures/dbo']/*[local-name()='StoredProcedureResultSet0' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/ProceduresResultSets/dbo/InterfaceTranspakInvStatus']/*[local-name()='InterfaceStatus' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/ProceduresResultSets/dbo/InterfaceTranspakInvStatus']/text())&quot;);" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="AssignVar" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                                <om:Element Type="Decision" OID="c13a2845-397e-45ea-9a07-b208a4209514" ParentLink="ComplexStatement_Statement" LowerBound="150.1" HigherBound="226.1">
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Chk_LHDN_Resp_Empty" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="DecisionBranch" OID="ff2f491e-29a4-4898-90f4-90ad7081ec24" ParentLink="ReallyComplexStatement_Branch" LowerBound="151.29" HigherBound="154.1">
                                        <om:Property Name="Expression" Value="varStatusCode == &quot;&quot;" />
                                        <om:Property Name="IsGhostBranch" Value="True" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="If_Empty" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                    <om:Element Type="DecisionBranch" OID="6841f7f6-15c6-4bbd-b1c8-da7da27121dd" ParentLink="ReallyComplexStatement_Branch">
                                        <om:Property Name="IsGhostBranch" Value="True" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Else" />
                                        <om:Property Name="Signal" Value="False" />
                                        <om:Element Type="Construct" OID="337a81fd-8359-4527-a697-36d9c6fba95a" ParentLink="ComplexStatement_Statement" LowerBound="156.1" HigherBound="166.1">
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="Const_RespFF" />
                                            <om:Property Name="Signal" Value="True" />
                                            <om:Element Type="MessageAssignment" OID="ed48be09-6e2f-48fa-9bc7-5a287fe5570b" ParentLink="ComplexStatement_Statement" LowerBound="159.1" HigherBound="165.1">
                                                <om:Property Name="Expression" Value="varTempXML = new System.Xml.XmlDocument();&#xD;&#xA;varTempXML.LoadXml(&quot;&lt;InvoiceResponse&gt;&lt;InvoiceNumber&gt;&quot; + varInvoiceNo + &quot;&lt;/InvoiceNumber&gt;&lt;UUID&gt;&quot; + varUUID + &quot;&lt;/UUID&gt;&lt;LongID&gt;&quot; + varLongId + &quot;&lt;/LongID&gt;&lt;StatusCode&gt;&quot; + varStatusCode + &quot;&lt;/StatusCode&gt;&lt;StatusMessage&gt;&quot; + varStatusMsg + &quot;&lt;/StatusMessage&gt;&lt;ValidationDateTime&gt;&quot; + varValidationDateTime + &quot;&lt;/ValidationDateTime&gt;&lt;/InvoiceResponse&gt;&quot;);&#xD;&#xA;msgResponseFF = varTempXML;&#xD;&#xA;varFileName = &quot;TPGG_IR_&quot; + varInvoiceNo + &quot;_&quot; + System.DateTime.Now.ToString(&quot;yyyyMMddHHmmssfff&quot;) + &quot;.xml&quot;;&#xD;&#xA;msgResponseFF(FILE.ReceivedFileName) = varFileName;" />
                                                <om:Property Name="ReportToAnalyst" Value="False" />
                                                <om:Property Name="Name" Value="MessageAssignment_2" />
                                                <om:Property Name="Signal" Value="True" />
                                            </om:Element>
                                            <om:Element Type="MessageRef" OID="e5e88c50-16e4-4ed3-af0b-83cf41ac1b99" ParentLink="Construct_MessageRef" LowerBound="157.43" HigherBound="157.56">
                                                <om:Property Name="Ref" Value="msgResponseFF" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                        </om:Element>
                                        <om:Element Type="VariableAssignment" OID="8f12edaf-8db1-408f-8e87-ddbbf98e6dd9" ParentLink="ComplexStatement_Statement" LowerBound="166.1" HigherBound="181.1">
                                            <om:Property Name="Expression" Value="&#xA;if(System.Convert.ToString(Sp.Transpak.Common.SSOClientHelper.Read(&quot;Sp.Transpak&quot;, &quot;ShowTranspakAdminLogs&quot;)) == &quot;Yes&quot;)&#xA;{&#xA;    varTempXML = new System.Xml.XmlDocument();&#xA;    varTempXML = msgResponseFF;&#xA;    if(varTempXML.OuterXml.Length &lt; 30000)&#xA;    {&#xA;        System.Diagnostics.EventLog.WriteEntry(&quot;msgResponseFF&quot;,varTempXML.OuterXml);&#xA;    }&#xA;    else&#xA;    {&#xA;        System.Diagnostics.EventLog.WriteEntry(&quot;msgResponseFF&quot;,varTempXML.OuterXml.Substring(0,29500));&#xA;    }&#xA;}" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="ShowLogs" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                        <om:Element Type="Construct" OID="9fcfa76b-2505-4d37-b97d-08f1e5d9425c" ParentLink="ComplexStatement_Statement" LowerBound="181.1" HigherBound="189.1">
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="Const_UpdStatusUpd" />
                                            <om:Property Name="Signal" Value="True" />
                                            <om:Element Type="MessageRef" OID="ae3cb157-abce-427e-b796-e4ff52959498" ParentLink="Construct_MessageRef" LowerBound="182.43" HigherBound="182.58">
                                                <om:Property Name="Ref" Value="msgUpdStatusReq" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                            <om:Element Type="MessageAssignment" OID="818764ee-3cee-4620-bd5a-b003694c451c" ParentLink="ComplexStatement_Statement" LowerBound="184.1" HigherBound="188.1">
                                                <om:Property Name="Expression" Value="varTempXML = new System.Xml.XmlDocument();&#xD;&#xA;varTempXML.LoadXml(&quot;&lt;ns0:InterfaceTranspakInvStatusUpd xmlns:ns0='http://schemas.microsoft.com/Sql/2008/05/TypedProcedures/dbo'&gt;&lt;ns0:DocumentID&gt;&quot; + varDocId + &quot;&lt;/ns0:DocumentID&gt;&lt;ns0:StatusType&gt;LHDN&lt;/ns0:StatusType&gt;&lt;ns0:Status&gt;&quot; + varInterfaceStatus + &quot;&lt;/ns0:Status&gt;&lt;ns0:StatusMessage&gt;&quot; + varStatusMsg + &quot;&lt;/ns0:StatusMessage&gt;&lt;ns0:StatusDateTime&gt;&quot; + varValidationDateTime + &quot;&lt;/ns0:StatusDateTime&gt;&lt;ns0:PeppolInvoiceXMLPath&gt;-&lt;/ns0:PeppolInvoiceXMLPath&gt;&lt;/ns0:InterfaceTranspakInvStatusUpd&gt;&quot;);&#xD;&#xA;msgUpdStatusReq = varTempXML;&#xD;&#xA;" />
                                                <om:Property Name="ReportToAnalyst" Value="False" />
                                                <om:Property Name="Name" Value="MessageAssignment_4" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                        </om:Element>
                                        <om:Element Type="VariableAssignment" OID="96d8b8a1-4606-45f2-b6d8-0d68a986a9e9" ParentLink="ComplexStatement_Statement" LowerBound="189.1" HigherBound="204.1">
                                            <om:Property Name="Expression" Value="&#xA;if(System.Convert.ToString(Sp.Transpak.Common.SSOClientHelper.Read(&quot;Sp.Transpak&quot;, &quot;ShowTranspakAdminLogs&quot;)) == &quot;Yes&quot;)&#xA;{&#xA;    varTempXML = new System.Xml.XmlDocument();&#xA;    varTempXML = msgUpdStatusReq;&#xA;    if(varTempXML.OuterXml.Length &lt; 30000)&#xA;    {&#xA;        System.Diagnostics.EventLog.WriteEntry(&quot;msgInvStatusUpdReq&quot;,varTempXML.OuterXml);&#xA;    }&#xA;    else&#xA;    {&#xA;        System.Diagnostics.EventLog.WriteEntry(&quot;msgInvStatusUpdReq&quot;,varTempXML.OuterXml.Substring(1,29500));&#xA;    }&#xA;}" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="ShowLogs" />
                                            <om:Property Name="Signal" Value="True" />
                                        </om:Element>
                                        <om:Element Type="Send" OID="e2d81894-b1fe-46ff-8360-73ddd89c72ed" ParentLink="ComplexStatement_Statement" LowerBound="204.1" HigherBound="206.1">
                                            <om:Property Name="PortName" Value="Port_SndRcvTranspakInvStatusUpd" />
                                            <om:Property Name="MessageName" Value="msgUpdStatusReq" />
                                            <om:Property Name="OperationName" Value="Operation_1" />
                                            <om:Property Name="OperationMessageName" Value="Request" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="Send_1" />
                                            <om:Property Name="Signal" Value="True" />
                                        </om:Element>
                                        <om:Element Type="Receive" OID="118ee0f2-a6aa-4868-8aa0-45d385d0353d" ParentLink="ComplexStatement_Statement" LowerBound="206.1" HigherBound="208.1">
                                            <om:Property Name="Activate" Value="False" />
                                            <om:Property Name="PortName" Value="Port_SndRcvTranspakInvStatusUpd" />
                                            <om:Property Name="MessageName" Value="msgUpdStatusResp" />
                                            <om:Property Name="OperationName" Value="Operation_1" />
                                            <om:Property Name="OperationMessageName" Value="Response" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="Receive_3" />
                                            <om:Property Name="Signal" Value="True" />
                                        </om:Element>
                                        <om:Element Type="Send" OID="b55abcab-f17b-46e3-89d1-dd1cbdcc15ff" ParentLink="ComplexStatement_Statement" LowerBound="208.1" HigherBound="210.1">
                                            <om:Property Name="PortName" Value="Port_SndTranspakInvRespFFTPPG" />
                                            <om:Property Name="MessageName" Value="msgResponseFF" />
                                            <om:Property Name="OperationName" Value="Operation_1" />
                                            <om:Property Name="OperationMessageName" Value="Request" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="Send_6" />
                                            <om:Property Name="Signal" Value="True" />
                                        </om:Element>
                                        <om:Element Type="VariableAssignment" OID="472206b7-5705-4c10-979f-9875f93e97a5" ParentLink="ComplexStatement_Statement" LowerBound="210.1" HigherBound="225.1">
                                            <om:Property Name="Expression" Value="&#xA;if(System.Convert.ToString(Sp.Transpak.Common.SSOClientHelper.Read(&quot;Sp.Transpak&quot;, &quot;ShowTranspakAdminLogs&quot;)) == &quot;Yes&quot;)&#xA;{&#xA;    varTempXML = new System.Xml.XmlDocument();&#xA;    varTempXML = msgUpdStatusResp;&#xA;    if(varTempXML.OuterXml.Length &lt; 30000)&#xA;    {&#xA;        System.Diagnostics.EventLog.WriteEntry(&quot;msgUpdStatusResp&quot;,varTempXML.OuterXml);&#xA;    }&#xA;    else&#xA;    {&#xA;        System.Diagnostics.EventLog.WriteEntry(&quot;msgUpdStatusResp&quot;,varTempXML.OuterXml.Substring(0,29500));&#xA;    }&#xA;}" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="ShowLogs" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                    </om:Element>
                                </om:Element>
                            </om:Element>
                            <om:Element Type="DecisionBranch" OID="6bbb36d6-c4ff-4b8f-a8ee-4b8b0be18fc4" ParentLink="ReallyComplexStatement_Branch">
                                <om:Property Name="IsGhostBranch" Value="True" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Else" />
                                <om:Property Name="Signal" Value="False" />
                                <om:Element Type="Construct" OID="f657317d-94be-48d0-8ba2-b3ca6ab649aa" ParentLink="ComplexStatement_Statement" LowerBound="229.1" HigherBound="240.1">
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Const_msgRespFF" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="MessageAssignment" OID="d8674f8e-34e2-4d80-87b8-03d17bb3589a" ParentLink="ComplexStatement_Statement" LowerBound="232.1" HigherBound="239.1">
                                        <om:Property Name="Expression" Value="varTempXML = new System.Xml.XmlDocument();&#xD;&#xA;//varTempXML.LoadXml(&quot;&lt;ns0:InvoiceResponse xmlns:ns0='http://Sp.Transpak.Schemas.TranspakInvoiceResponse'&gt;&lt;InvoiceNumber&gt;&quot; + varInvoiceNo + &quot;&lt;/InvoiceNumber&gt;&lt;UUID&gt;&lt;/UUID&gt;&lt;LongID&gt;&lt;/LongID&gt;&lt;StatusCode&gt;ValidationFailed&lt;/StatusCode&gt;&lt;StatusMessage&gt;&quot; + varStatusMsg + &quot;&lt;/StatusMessage&gt;&lt;ValidationDateTime&gt;&quot; + varValidationDateTime + &quot;&lt;/ValidationDateTime&gt;&lt;/ns0:InvoiceResponse&gt;&quot;);&#xD;&#xA;varTempXML.LoadXml(&quot;&lt;InvoiceResponse&gt;&lt;InvoiceNumber&gt;&quot; + varInvoiceNo + &quot;&lt;/InvoiceNumber&gt;&lt;UUID&gt;-&lt;/UUID&gt;&lt;LongID&gt;-&lt;/LongID&gt;&lt;StatusCode&gt;ValidationFailed&lt;/StatusCode&gt;&lt;StatusMessage&gt;&quot; + varStatusMsg + &quot;&lt;/StatusMessage&gt;&lt;ValidationDateTime&gt;&quot; + varValidationDateTime + &quot;&lt;/ValidationDateTime&gt;&lt;/InvoiceResponse&gt;&quot;);&#xD;&#xA;msgResponseFF = varTempXML;&#xD;&#xA;varFileName = &quot;TPPG_IR_&quot; + varInvoiceNo + &quot;_&quot; + System.DateTime.Now.ToString(&quot;yyyyMMddHHmmssfff&quot;) + &quot;.xml&quot;;&#xD;&#xA;msgResponseFF(FILE.ReceivedFileName) = varFileName;" />
                                        <om:Property Name="ReportToAnalyst" Value="False" />
                                        <om:Property Name="Name" Value="MessageAssignment_2" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                    <om:Element Type="MessageRef" OID="e806870b-f059-47b1-beea-4d0e35b741fa" ParentLink="Construct_MessageRef" LowerBound="230.39" HigherBound="230.52">
                                        <om:Property Name="Ref" Value="msgResponseFF" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="VariableAssignment" OID="6d0c4571-6263-410a-9b0e-b1067a55198e" ParentLink="ComplexStatement_Statement" LowerBound="240.1" HigherBound="255.1">
                                    <om:Property Name="Expression" Value="&#xA;if(System.Convert.ToString(Sp.Transpak.Common.SSOClientHelper.Read(&quot;Sp.Transpak&quot;, &quot;ShowTranspakAdminLogs&quot;)) == &quot;Yes&quot;)&#xA;{&#xA;    varTempXML = new System.Xml.XmlDocument();&#xA;    varTempXML = msgResponseFF;&#xA;    if(varTempXML.OuterXml.Length &lt; 30000)&#xA;    {&#xA;        System.Diagnostics.EventLog.WriteEntry(&quot;msgResponseFF&quot;,varTempXML.OuterXml);&#xA;    }&#xA;    else&#xA;    {&#xA;        System.Diagnostics.EventLog.WriteEntry(&quot;msgResponseFF&quot;,varTempXML.OuterXml.Substring(0,29500));&#xA;    }&#xA;}" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="ShowLogs" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="Construct" OID="d231a7e3-c580-451e-be8a-c0724a088beb" ParentLink="ComplexStatement_Statement" LowerBound="255.1" HigherBound="263.1">
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Const_UpdStatusUpd" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="MessageAssignment" OID="2669cb46-5f43-42dc-a465-5d135b9a114a" ParentLink="ComplexStatement_Statement" LowerBound="258.1" HigherBound="262.1">
                                        <om:Property Name="Expression" Value="varTempXML = new System.Xml.XmlDocument();&#xD;&#xA;varTempXML.LoadXml(&quot;&lt;ns0:InterfaceTranspakInvStatusUpd xmlns:ns0='http://schemas.microsoft.com/Sql/2008/05/TypedProcedures/dbo'&gt;&lt;ns0:DocumentID&gt;&quot; + varDocId + &quot;&lt;/ns0:DocumentID&gt;&lt;ns0:StatusType&gt;LHDN&lt;/ns0:StatusType&gt;&lt;ns0:Status&gt;&quot; + varInterfaceStatus + &quot;&lt;/ns0:Status&gt;&lt;ns0:StatusMessage&gt;&quot; + varStatusMsg + &quot;&lt;/ns0:StatusMessage&gt;&lt;ns0:StatusDateTime&gt;&quot; + varValidationDateTime + &quot;&lt;/ns0:StatusDateTime&gt;&lt;ns0:PeppolInvoiceXMLPath&gt;-&lt;/ns0:PeppolInvoiceXMLPath&gt;&lt;/ns0:InterfaceTranspakInvStatusUpd&gt;&quot;);&#xD;&#xA;msgUpdStatusReq = varTempXML;&#xD;&#xA;" />
                                        <om:Property Name="ReportToAnalyst" Value="False" />
                                        <om:Property Name="Name" Value="MessageAssignment_4" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                    <om:Element Type="MessageRef" OID="f74ea0d9-db2a-4f05-866e-45c2664e127c" ParentLink="Construct_MessageRef" LowerBound="256.39" HigherBound="256.54">
                                        <om:Property Name="Ref" Value="msgUpdStatusReq" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="VariableAssignment" OID="6e131634-97c3-4fca-b654-07fb7b050d46" ParentLink="ComplexStatement_Statement" LowerBound="263.1" HigherBound="278.1">
                                    <om:Property Name="Expression" Value="&#xA;if(System.Convert.ToString(Sp.Transpak.Common.SSOClientHelper.Read(&quot;Sp.Transpak&quot;, &quot;ShowTranspakAdminLogs&quot;)) == &quot;Yes&quot;)&#xA;{&#xA;    varTempXML = new System.Xml.XmlDocument();&#xA;    varTempXML = msgUpdStatusReq;&#xA;    if(varTempXML.OuterXml.Length &lt; 30000)&#xA;    {&#xA;        System.Diagnostics.EventLog.WriteEntry(&quot;msgInvStatusUpdReq&quot;,varTempXML.OuterXml);&#xA;    }&#xA;    else&#xA;    {&#xA;        System.Diagnostics.EventLog.WriteEntry(&quot;msgInvStatusUpdReq&quot;,varTempXML.OuterXml.Substring(1,29500));&#xA;    }&#xA;}" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="ShowLogs" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                                <om:Element Type="Send" OID="b76720d8-080f-4e18-9627-dba9d3da9d49" ParentLink="ComplexStatement_Statement" LowerBound="278.1" HigherBound="280.1">
                                    <om:Property Name="PortName" Value="Port_SndRcvTranspakInvStatusUpd" />
                                    <om:Property Name="MessageName" Value="msgUpdStatusReq" />
                                    <om:Property Name="OperationName" Value="Operation_1" />
                                    <om:Property Name="OperationMessageName" Value="Request" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Send_5" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                                <om:Element Type="Receive" OID="33358af0-4fd5-456f-9a82-5439e30911cf" ParentLink="ComplexStatement_Statement" LowerBound="280.1" HigherBound="282.1">
                                    <om:Property Name="Activate" Value="False" />
                                    <om:Property Name="PortName" Value="Port_SndRcvTranspakInvStatusUpd" />
                                    <om:Property Name="MessageName" Value="msgUpdStatusResp" />
                                    <om:Property Name="OperationName" Value="Operation_1" />
                                    <om:Property Name="OperationMessageName" Value="Response" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Receive_4" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                                <om:Element Type="Send" OID="817b99a1-939c-45a2-a883-a84d8e8c0d90" ParentLink="ComplexStatement_Statement" LowerBound="282.1" HigherBound="284.1">
                                    <om:Property Name="PortName" Value="Port_SndTranspakInvRespFFTPPG" />
                                    <om:Property Name="MessageName" Value="msgResponseFF" />
                                    <om:Property Name="OperationName" Value="Operation_1" />
                                    <om:Property Name="OperationMessageName" Value="Request" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Send_7" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                            </om:Element>
                        </om:Element>
                        <om:Element Type="Catch" OID="0c069be8-373d-40cb-be5e-4627442a96b2" ParentLink="Scope_Catch" LowerBound="288.1" HigherBound="344.1">
                            <om:Property Name="ExceptionName" Value="ex" />
                            <om:Property Name="ExceptionType" Value="System.Exception" />
                            <om:Property Name="IsFaultMessage" Value="False" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="System Exception" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="VariableAssignment" OID="20e0926a-b037-49ab-99b7-c60460400e12" ParentLink="Catch_Statement" LowerBound="291.1" HigherBound="302.1">
                                <om:Property Name="Expression" Value="System.Diagnostics.EventLog.WriteEntry(&quot;TranspakTSPAPIUpdateException&quot;,ex.Message);&#xD;&#xA;varExceptionmsg = ex.Message;&#xD;&#xA;varExceptionmsg = varExceptionmsg.Replace(&quot;&amp;&quot;,&quot;&amp;amp;&quot;);&#xD;&#xA;varExceptionmsg = varExceptionmsg.Replace(&quot;'&quot;,&quot;''&quot;);&#xD;&#xA;varExceptionmsg = varExceptionmsg.Replace(&quot;&lt;&quot;,&quot;&amp;lt;&quot;);&#xD;&#xA;varExceptionmsg = varExceptionmsg.Replace(&quot;&gt;&quot;,&quot;&amp;gt;&quot;);&#xD;&#xA;if(varExceptionmsg.Length &gt; 1000)&#xD;&#xA;{&#xD;&#xA;    varExceptionmsg = varExceptionmsg.Substring(0,999);&#xD;&#xA;}" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="ExceptionMsg" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                            <om:Element Type="Construct" OID="30da2980-58ad-4d88-968a-7d6cb5829bb9" ParentLink="Catch_Statement" LowerBound="302.1" HigherBound="311.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="const_ErrorLogsTable" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="MessageRef" OID="4a808dcc-f0f7-4382-9317-5f12c37ee280" ParentLink="Construct_MessageRef" LowerBound="303.39" HigherBound="303.51">
                                    <om:Property Name="Ref" Value="msgErrorLogs" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="MessageAssignment" OID="7d744bf0-d4f5-46df-9f1c-3be39c35415d" ParentLink="ComplexStatement_Statement" LowerBound="305.1" HigherBound="310.1">
                                    <om:Property Name="Expression" Value="varTempXML = new System.Xml.XmlDocument();&#xD;&#xA;varTempXML.LoadXml(&quot;&lt;ns0:InterfaceErrorLogs xmlns:ns0='http://schemas.microsoft.com/Sql/2008/05/TypedProcedures/dbo'&gt;&lt;ns0:HubID&gt;TPGG&lt;/ns0:HubID&gt;&lt;ns0:DocumentID&gt;&quot; + varDocId + &quot;&lt;/ns0:DocumentID&gt;&lt;ns0:DocumentType&gt;TSPInvoiceResponse&lt;/ns0:DocumentType&gt;&lt;ns0:DocumentNumber&gt;&quot; + varInvoiceNo + &quot;&lt;/ns0:DocumentNumber&gt;&lt;ns0:ModuleName&gt;Process_TranspakInvResponse_TSP&lt;/ns0:ModuleName&gt;&lt;ns0:ExceptionType&gt;&quot; + ex.Source + &quot;&lt;/ns0:ExceptionType&gt;&lt;ns0:ErrorMessage&gt;&quot; + varExceptionmsg + &quot;&lt;/ns0:ErrorMessage&gt;&lt;ns0:VendorCode&gt;-&lt;/ns0:VendorCode&gt;&lt;ns0:DocumentPath&gt;-&lt;/ns0:DocumentPath&gt;&lt;/ns0:InterfaceErrorLogs&gt;&quot;);&#xD;&#xA;msgErrorLogs.Body = varTempXML;&#xD;&#xA;&#xD;&#xA;" />
                                    <om:Property Name="ReportToAnalyst" Value="False" />
                                    <om:Property Name="Name" Value="MessageAssignment_3" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Send" OID="7ee369ab-ec62-4fa2-bdb4-7a7b469cc579" ParentLink="Catch_Statement" LowerBound="311.1" HigherBound="313.1">
                                <om:Property Name="PortName" Value="Port_SndTranspakErrorLogs" />
                                <om:Property Name="MessageName" Value="msgErrorLogs" />
                                <om:Property Name="OperationName" Value="Operation_1" />
                                <om:Property Name="OperationMessageName" Value="Request" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Send_4" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                            <om:Element Type="Construct" OID="c4603a7b-aa17-48f3-8aaf-61e4e24005b3" ParentLink="Catch_Statement" LowerBound="313.1" HigherBound="341.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Const_ErrorEmail" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="MessageAssignment" OID="0f282479-b5e8-4f28-a2f3-06864aa6fb66" ParentLink="ComplexStatement_Statement" LowerBound="316.1" HigherBound="340.1">
                                    <om:Property Name="Expression" Value="System.Diagnostics.EventLog.WriteEntry(&quot;TranspakTPGGInvRespException&quot;,ex.Message);&#xD;&#xA;&#xD;&#xA;varEmailBody = new System.Text.StringBuilder();&#xD;&#xA;varEmailBody.AppendLine(&quot;&lt;html&gt;&lt;body&gt;&quot;);&#xD;&#xA;varEmailBody.AppendLine(&quot;&lt;p&gt;Transpak_TPGG Invoice Resp Status update failed while Updating in SESAMi.&lt;/p&gt;&quot;);&#xD;&#xA;varEmailBody.AppendLine(&quot;&lt;p&gt;&lt;b&gt;&lt;u&gt;Error details:&lt;/u&gt;&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&quot;);&#xD;&#xA;varEmailBody.AppendLine(&quot;&lt;b&gt;Application Name&lt;/b&gt; : &lt;i&gt;Sp.Transpak&lt;/i&gt;&lt;br/&gt;&quot;);&#xD;&#xA;varEmailBody.AppendLine(&quot;&lt;b&gt;Process Name&lt;/b&gt; : &lt;i&gt;Process_TranspakInvResponse_TPGG&lt;/i&gt;&lt;br/&gt;&quot;);&#xD;&#xA;varEmailBody.AppendLine(&quot;&lt;b&gt;DocId&lt;/b&gt; : &lt;i&gt;&quot; + varDocId  + &quot;&lt;/i&gt;&lt;br/&gt;&quot;);&#xD;&#xA;varEmailBody.AppendLine(&quot;&lt;b&gt;Failure Code&lt;/b&gt; : &quot; + ex.Source + &quot;&lt;br/&gt;&quot;);&#xD;&#xA;varEmailBody.AppendLine(&quot;&lt;b&gt;Error Description&lt;/b&gt; : &lt;i&gt;&quot; + ex.Message + &quot;&lt;/i&gt;&lt;br/&gt;&quot;);&#xD;&#xA;varEmailBody.AppendLine(&quot;&lt;/body&gt;&lt;/html&gt;&quot;);&#xD;&#xA;msgErrorEmail.Body = new Sp.Transpak.Common.RawString(varEmailBody.ToString());&#xD;&#xA;Sp.Transpak.Common.SMTPUtils.SetContentType(msgErrorEmail.Body,&quot;text/html&quot;);&#xD;&#xA;Port_SndTranspakTSPInvRespErrorEmail(Microsoft.XLANGs.BaseTypes.Address) = Sp.Transpak.Common.SSOClientHelper.Read(&quot;Sp.Transpak&quot;, &quot;SMTPTo&quot;);&#xD;&#xA;&#xD;&#xA;msgErrorEmail(SMTP.From) = Sp.Transpak.Common.SSOClientHelper.Read(&quot;Sp.Transpak&quot;, &quot;SMTPFrom&quot;);&#xD;&#xA;&#xD;&#xA;msgErrorEmail(SMTP.Subject) = &quot;Transpak TPGG Invoice Resp status failed while updating status for Invoice: &quot; + varInvoiceNo;&#xD;&#xA;&#xD;&#xA;msgErrorEmail(SMTP.EmailBodyFileCharset) = &quot;UTF-8&quot;;&#xD;&#xA;msgErrorEmail(SMTP.CC) = Sp.Transpak.Common.SSOClientHelper.Read(&quot;Sp.Transpak&quot;, &quot;SMTPCCopy&quot;);&#xD;&#xA;msgErrorEmail(SMTP.SMTPHost)= Sp.Transpak.Common.SSOClientHelper.Read(&quot;Sp.Transpak&quot;, &quot;SMTPHost&quot;);" />
                                    <om:Property Name="ReportToAnalyst" Value="False" />
                                    <om:Property Name="Name" Value="MessageAssignment_1" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="MessageRef" OID="982ddb94-11e1-49ab-a03e-54d0467b2468" ParentLink="Construct_MessageRef" LowerBound="314.39" HigherBound="314.52">
                                    <om:Property Name="Ref" Value="msgErrorEmail" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Send" OID="44551b82-33ba-4ddf-8a76-26004d92d331" ParentLink="Catch_Statement" LowerBound="341.1" HigherBound="343.1">
                                <om:Property Name="PortName" Value="Port_SndTranspakTSPInvRespErrorEmail" />
                                <om:Property Name="MessageName" Value="msgErrorEmail" />
                                <om:Property Name="OperationName" Value="Operation_1" />
                                <om:Property Name="OperationMessageName" Value="Request" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Send_3" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                        </om:Element>
                    </om:Element>
                    <om:Element Type="Delay" OID="ca7eda8b-607e-4aba-b4cf-8df0b849c016" ParentLink="ComplexStatement_Statement" LowerBound="346.1" HigherBound="348.1">
                        <om:Property Name="Timeout" Value="new System.TimeSpan(0,0,0,0,System.Convert.ToInt32(Sp.Transpak.Common.SSOClientHelper.Read(&quot;Sp.Transpak&quot;, &quot;TranspakDelayinMS&quot;)));" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Delay_SSO" />
                        <om:Property Name="Signal" Value="True" />
                    </om:Element>
                </om:Element>
                <om:Element Type="VariableAssignment" OID="f933b88e-a133-4b8e-925b-47900751f713" ParentLink="ServiceBody_Statement" LowerBound="349.1" HigherBound="351.1">
                    <om:Property Name="Expression" Value="System.Diagnostics.EventLog.WriteEntry(&quot;Transpak_TPPG Invoice Response Process End&quot;,&quot;Transpak_TPPG Invoice Response Process Completed&quot;);" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Process_End" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="3981fdeb-3f05-40ab-9a02-808b870df964" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="21.1" HigherBound="23.1">
                <om:Property Name="PortModifier" Value="Implements" />
                <om:Property Name="Orientation" Value="Left" />
                <om:Property Name="PortIndex" Value="-1" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="Sp.Transpak.Orchestrations.PortType_RcvTranspakLHDNSentInvTPPG" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Port_RcvTranspakLHDNSentInvTPPG" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="LogicalBindingAttribute" OID="74f230e8-88ea-4a1b-bc58-5ab1f6dda690" ParentLink="PortDeclaration_CLRAttribute" LowerBound="21.1" HigherBound="22.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="3067cf8f-b8ac-4f00-8e5a-f1698e90e215" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="23.1" HigherBound="25.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="43" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="Sp.Transpak.Orchestrations.PortType_SndRcvTranspakInvStatusPeppolDB" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Port_SndRcvTranspakInvStatusPeppolDB" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="LogicalBindingAttribute" OID="861696b6-2b49-49a8-871f-49b3c9a14782" ParentLink="PortDeclaration_CLRAttribute" LowerBound="23.1" HigherBound="24.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="0573da3c-52b1-4937-8660-fb7d745a4196" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="25.1" HigherBound="27.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="91" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="Sp.Transpak.Orchestrations.PortType_SndRcvTranspakInvStatusUpd" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Port_SndRcvTranspakInvStatusUpd" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="LogicalBindingAttribute" OID="902925da-dc95-4215-a7fb-5cc6d21b515f" ParentLink="PortDeclaration_CLRAttribute" LowerBound="25.1" HigherBound="26.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="cc27a12c-10c1-49c5-8e1b-f54b179404df" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="27.1" HigherBound="29.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="127" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="Sp.Transpak.Orchestrations.PortType_SndTranspakErrorLogs" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Port_SndTranspakErrorLogs" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="LogicalBindingAttribute" OID="0989e650-3cc0-4df2-8905-cc072841ef69" ParentLink="PortDeclaration_CLRAttribute" LowerBound="27.1" HigherBound="28.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="a4c9eadc-38f0-46b2-865f-3e05aff7663b" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="29.1" HigherBound="31.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="-1" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="Sp.Transpak.Orchestrations.PortType_SndTranspakTSPInvRespErrorEmail" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Port_SndTranspakTSPInvRespErrorEmail" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="PhysicalBindingAttribute" OID="cda63859-0f81-4407-bf8f-14f0cb3e33c6" ParentLink="PortDeclaration_CLRAttribute" LowerBound="29.1" HigherBound="30.1">
                    <om:Property Name="InPipeline" Value="Microsoft.BizTalk.DefaultPipelines.XMLReceive" />
                    <om:Property Name="OutPipeline" Value="Microsoft.BizTalk.DefaultPipelines.PassThruTransmit" />
                    <om:Property Name="TransportType" Value="HTTP" />
                    <om:Property Name="URI" Value="http://tempURI" />
                    <om:Property Name="IsDynamic" Value="True" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="4f18f9ab-976d-47b3-a56e-c1b245065065" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="31.1" HigherBound="33.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="105" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="Sp.Transpak.Orchestrations.PortType_SndTranspakInvRespFFTPPG" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Port_SndTranspakInvRespFFTPPG" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="LogicalBindingAttribute" OID="46e56d65-6668-4ff2-850e-eec94fbea86f" ParentLink="PortDeclaration_CLRAttribute" LowerBound="31.1" HigherBound="32.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
    </om:Element>
</om:MetaModel>
#endif // __DESIGNER_DATA
[Microsoft.XLANGs.BaseTypes.BPELExportable(false)]
module Sp.Transpak.Orchestrations
{
    internal porttype PortType_RcvTranspakLHDNSentInvTPPG
    {
        oneway Operation_1
        {
            Sp.Transpak.Schemas.uspLHDNSentTPGG_TypedPolling_InterfaceLHDNSentTranspakInvoices_TPGG.TypedPolling
        };
    };
    internal porttype PortType_SndTranspakInvRespFFTPPG
    {
        oneway Operation_1
        {
            Sp.Transpak.Schemas.TranspakInvoiceResponse
        };
    };
    [Microsoft.XLANGs.BaseTypes.BPELExportable(false)]
    internal service Process_TranspakInvResponse_TPPG
    {
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port implements PortType_RcvTranspakLHDNSentInvTPPG Port_RcvTranspakLHDNSentInvTPPG;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses PortType_SndRcvTranspakInvStatusPeppolDB Port_SndRcvTranspakInvStatusPeppolDB;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses PortType_SndRcvTranspakInvStatusUpd Port_SndRcvTranspakInvStatusUpd;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses PortType_SndTranspakErrorLogs Port_SndTranspakErrorLogs;
        [Microsoft.XLANGs.BaseTypes.PhysicalBinding(typeof(Microsoft.BizTalk.DefaultPipelines.PassThruTransmit))]
        port uses dynamic PortType_SndTranspakTSPInvRespErrorEmail Port_SndTranspakTSPInvRespErrorEmail;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses PortType_SndTranspakInvRespFFTPPG Port_SndTranspakInvRespFFTPPG;
        message Sp.Transpak.Schemas.uspInvoiceStatusupd_TypedProcedure_dbo.InterfaceTranspakInvStatusUpdResponse msgUpdStatusResp;
        message Sp.Transpak.Schemas.uspInvoiceStatusupd_TypedProcedure_dbo.InterfaceTranspakInvStatusUpd msgUpdStatusReq;
        message Sp.Transpak.Schemas.uspLHDNSentTPGG_TypedPolling_InterfaceLHDNSentTranspakInvoices_TPGG.TypedPollingResultSet0 msgSingleInvoice;
        message Sp.Transpak.Schemas.TranspakInvoiceResponse msgResponseFF;
        message Sp.Transpak.Schemas.uspLHDNSentTPGG_TypedPolling_InterfaceLHDNSentTranspakInvoices_TPGG.TypedPolling msgPollInvoices;
        message Sp.Transpak.Schemas.uspTranspakInvStatusPeppolDb_TypedProcedure_dbo.InterfaceTranspakInvStatusResponse msgLHDNInvStatusResp;
        message Sp.Transpak.Schemas.uspTranspakInvStatusPeppolDb_TypedProcedure_dbo.InterfaceTranspakInvStatus msgLHDNInvStatus;
        message msgMultiErrorLogs msgErrorLogs;
        message msgMultiErrorEmail msgErrorEmail;
        System.String varValidationDateTime;
        System.String varUUID;
        System.Xml.XmlDocument varTempXML;
        System.String varSubmissionID;
        System.String varStatusMsg;
        System.String varStatusCode;
        System.String varLoopItem;
        System.Int32 varLoopCounter;
        System.String varLongId;
        System.String varInvoiceNo;
        System.String varInterfaceStatus;
        System.String varFileName;
        System.String varExceptionmsg;
        System.Text.StringBuilder varEmailBody;
        System.String varDocId;
        System.Int32 varDocCount;
        body ()
        {
            [Microsoft.XLANGs.BaseTypes.DesignerPosition("c8dcf6d3-16e4-4738-b778-15cafc10e5d4")]
            activate receive (Port_RcvTranspakLHDNSentInvTPPG.Operation_1, msgPollInvoices);
            varValidationDateTime = "";
            varUUID = "";
            varTempXML = new System.Xml.XmlDocument();
            varSubmissionID = "";
            varStatusMsg = "";
            varStatusCode = "";
            varLoopItem = "";
            varLoopCounter = 0;
            varLongId = "";
            varInvoiceNo = "";
            varInterfaceStatus = "";
            varFileName = "";
            varExceptionmsg = "";
            varEmailBody = new System.Text.StringBuilder();
            varDocId = "";
            varDocCount = 0;
            [Microsoft.XLANGs.BaseTypes.DesignerPosition("5142c904-5921-44ee-bb39-e79b919364ec")]
            System.Diagnostics.EventLog.WriteEntry("Transpak_TPPG Invoice Response Process Start","Transpak_TPPG Invoice Response Process Started");
            varDocCount = xpath(msgPollInvoices,"count(/*[local-name()='TypedPolling' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/TypedPolling/InterfaceLHDNSentTranspakInvoices_TPPG']/*[local-name()='TypedPollingResultSet0' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/TypedPolling/InterfaceLHDNSentTranspakInvoices_TPPG']/*[local-name()='TypedPollingResultSet0' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/TypedPolling/InterfaceLHDNSentTranspakInvoices_TPPG']/*[local-name()='DocumentID' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/TypedPolling/InterfaceLHDNSentTranspakInvoices_TPPG'])");
            System.Diagnostics.EventLog.WriteEntry("Transpak_TPPG Inv Resp Doc Count",varDocCount.ToString());
            [Microsoft.XLANGs.BaseTypes.DesignerPosition("b363c2d6-4408-4c9b-872f-b00b4fca3cbb")]
            while (varLoopCounter < varDocCount)
            {
                [Microsoft.XLANGs.BaseTypes.DesignerPosition("b73b33cd-3d2b-483f-9a3b-f4098fc314f3")]
                scope
                {
                    body
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("61a1274e-3e98-45bf-a038-c691262e00f4")]
                        varLoopCounter = varLoopCounter + 1;
                        varLoopItem = varLoopCounter.ToString();
                        
                        varUUID = "";
                        varLongId = "";
                        varStatusCode = "";
                        varStatusMsg = "";
                        varValidationDateTime = "";
                        varInterfaceStatus = "";
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("55ba6b5b-95ba-4b9a-b2de-e73361201391")]
                        construct msgSingleInvoice
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("2596617f-29b4-4775-8ee8-58cb3487e1e7")]
                            msgSingleInvoice = xpath(msgPollInvoices, "/*[local-name()='TypedPolling' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/TypedPolling/InterfaceLHDNSentTranspakInvoices_TPPG']/*[local-name()='TypedPollingResultSet0' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/TypedPolling/InterfaceLHDNSentTranspakInvoices_TPPG']/*[local-name()='TypedPollingResultSet0' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/TypedPolling/InterfaceLHDNSentTranspakInvoices_TPPG']["+ varLoopItem +"]" );
                            varDocId = msgSingleInvoice.DocumentID;
                            varInvoiceNo = msgSingleInvoice.DocumentNumber;
                            varSubmissionID = msgSingleInvoice.SubmissionID;
                            varInterfaceStatus = msgSingleInvoice.InterfaceStatus;
                            varStatusMsg = msgSingleInvoice.InterfaceMessage;
                            varValidationDateTime = msgSingleInvoice.InterfaceDate;
                            
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("9e0193be-6e7f-4fb3-ae4d-28eb0f2a87e3")]
                        if (varInterfaceStatus == "LHDNSent")
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("1d3e3973-6340-4bcd-aeba-78f3fd41c469")]
                            construct msgLHDNInvStatus
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("b1326e2f-c5f7-4687-b671-fc7c2e053c23")]
                                varTempXML = new System.Xml.XmlDocument();
                                varTempXML.LoadXml("<ns0:InterfaceTranspakInvStatus xmlns:ns0='http://schemas.microsoft.com/Sql/2008/05/TypedProcedures/dbo'><ns0:DocumentID>" + varSubmissionID + "</ns0:DocumentID><ns0:InvoiceNumber>" + varInvoiceNo + "</ns0:InvoiceNumber></ns0:InterfaceTranspakInvStatus>");
                                msgLHDNInvStatus = varTempXML;
                            }
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("8b086b23-51f3-4b16-aa29-9f4c9de87e3f")]
                            
                            if(System.Convert.ToString(Sp.Transpak.Common.SSOClientHelper.Read("Sp.Transpak", "ShowTranspakAdminLogs")) == "Yes")
                            {
                                varTempXML = new System.Xml.XmlDocument();
                                varTempXML = msgLHDNInvStatus;
                                if(varTempXML.OuterXml.Length < 30000)
                                {
                                    System.Diagnostics.EventLog.WriteEntry("msgLHDNInvStatus",varTempXML.OuterXml);
                                }
                                else
                                {
                                    System.Diagnostics.EventLog.WriteEntry("msgLHDNInvStatus",varTempXML.OuterXml.Substring(1,29500));
                                }
                            }
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("3c94b701-35e6-4eaa-a7cf-7f65c92c6d05")]
                            send (Port_SndRcvTranspakInvStatusPeppolDB.Operation_1, msgLHDNInvStatus);
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("a1d84674-08ec-42cc-90d9-a4845052995d")]
                            receive (Port_SndRcvTranspakInvStatusPeppolDB.Operation_1, msgLHDNInvStatusResp);
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("7ebf084b-1a1e-4ec0-b980-526ed364330f")]
                            varUUID = xpath(msgLHDNInvStatusResp,"string(/*[local-name()='InterfaceTranspakInvStatusResponse' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/TypedProcedures/dbo']/*[local-name()='StoredProcedureResultSet0' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/TypedProcedures/dbo']/*[local-name()='StoredProcedureResultSet0' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/ProceduresResultSets/dbo/InterfaceTranspakInvStatus']/*[local-name()='UUID' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/ProceduresResultSets/dbo/InterfaceTranspakInvStatus']/text())");
                            varLongId = xpath(msgLHDNInvStatusResp,"string(/*[local-name()='InterfaceTranspakInvStatusResponse' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/TypedProcedures/dbo']/*[local-name()='StoredProcedureResultSet0' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/TypedProcedures/dbo']/*[local-name()='StoredProcedureResultSet0' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/ProceduresResultSets/dbo/InterfaceTranspakInvStatus']/*[local-name()='LongId' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/ProceduresResultSets/dbo/InterfaceTranspakInvStatus']/text())");
                            varStatusCode = xpath(msgLHDNInvStatusResp,"string(/*[local-name()='InterfaceTranspakInvStatusResponse' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/TypedProcedures/dbo']/*[local-name()='StoredProcedureResultSet0' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/TypedProcedures/dbo']/*[local-name()='StoredProcedureResultSet0' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/ProceduresResultSets/dbo/InterfaceTranspakInvStatus']/*[local-name()='Status' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/ProceduresResultSets/dbo/InterfaceTranspakInvStatus']/text())");
                            varStatusMsg = xpath(msgLHDNInvStatusResp,"string(/*[local-name()='InterfaceTranspakInvStatusResponse' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/TypedProcedures/dbo']/*[local-name()='StoredProcedureResultSet0' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/TypedProcedures/dbo']/*[local-name()='StoredProcedureResultSet0' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/ProceduresResultSets/dbo/InterfaceTranspakInvStatus']/*[local-name()='Message' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/ProceduresResultSets/dbo/InterfaceTranspakInvStatus']/text())");
                            varValidationDateTime = xpath(msgLHDNInvStatusResp,"string(/*[local-name()='InterfaceTranspakInvStatusResponse' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/TypedProcedures/dbo']/*[local-name()='StoredProcedureResultSet0' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/TypedProcedures/dbo']/*[local-name()='StoredProcedureResultSet0' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/ProceduresResultSets/dbo/InterfaceTranspakInvStatus']/*[local-name()='ValidationDateTime' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/ProceduresResultSets/dbo/InterfaceTranspakInvStatus']/text())");
                            varInterfaceStatus = xpath(msgLHDNInvStatusResp,"string(/*[local-name()='InterfaceTranspakInvStatusResponse' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/TypedProcedures/dbo']/*[local-name()='StoredProcedureResultSet0' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/TypedProcedures/dbo']/*[local-name()='StoredProcedureResultSet0' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/ProceduresResultSets/dbo/InterfaceTranspakInvStatus']/*[local-name()='InterfaceStatus' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/ProceduresResultSets/dbo/InterfaceTranspakInvStatus']/text())");
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("c13a2845-397e-45ea-9a07-b208a4209514")]
                            if (varStatusCode == "")
                            {
                            }
                            else 
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("337a81fd-8359-4527-a697-36d9c6fba95a")]
                                construct msgResponseFF
                                {
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("ed48be09-6e2f-48fa-9bc7-5a287fe5570b")]
                                    varTempXML = new System.Xml.XmlDocument();
                                    varTempXML.LoadXml("<InvoiceResponse><InvoiceNumber>" + varInvoiceNo + "</InvoiceNumber><UUID>" + varUUID + "</UUID><LongID>" + varLongId + "</LongID><StatusCode>" + varStatusCode + "</StatusCode><StatusMessage>" + varStatusMsg + "</StatusMessage><ValidationDateTime>" + varValidationDateTime + "</ValidationDateTime></InvoiceResponse>");
                                    msgResponseFF = varTempXML;
                                    varFileName = "TPGG_IR_" + varInvoiceNo + "_" + System.DateTime.Now.ToString("yyyyMMddHHmmssfff") + ".xml";
                                    msgResponseFF(FILE.ReceivedFileName) = varFileName;
                                }
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("8f12edaf-8db1-408f-8e87-ddbbf98e6dd9")]
                                
                                if(System.Convert.ToString(Sp.Transpak.Common.SSOClientHelper.Read("Sp.Transpak", "ShowTranspakAdminLogs")) == "Yes")
                                {
                                    varTempXML = new System.Xml.XmlDocument();
                                    varTempXML = msgResponseFF;
                                    if(varTempXML.OuterXml.Length < 30000)
                                    {
                                        System.Diagnostics.EventLog.WriteEntry("msgResponseFF",varTempXML.OuterXml);
                                    }
                                    else
                                    {
                                        System.Diagnostics.EventLog.WriteEntry("msgResponseFF",varTempXML.OuterXml.Substring(0,29500));
                                    }
                                }
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("9fcfa76b-2505-4d37-b97d-08f1e5d9425c")]
                                construct msgUpdStatusReq
                                {
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("818764ee-3cee-4620-bd5a-b003694c451c")]
                                    varTempXML = new System.Xml.XmlDocument();
                                    varTempXML.LoadXml("<ns0:InterfaceTranspakInvStatusUpd xmlns:ns0='http://schemas.microsoft.com/Sql/2008/05/TypedProcedures/dbo'><ns0:DocumentID>" + varDocId + "</ns0:DocumentID><ns0:StatusType>LHDN</ns0:StatusType><ns0:Status>" + varInterfaceStatus + "</ns0:Status><ns0:StatusMessage>" + varStatusMsg + "</ns0:StatusMessage><ns0:StatusDateTime>" + varValidationDateTime + "</ns0:StatusDateTime><ns0:PeppolInvoiceXMLPath>-</ns0:PeppolInvoiceXMLPath></ns0:InterfaceTranspakInvStatusUpd>");
                                    msgUpdStatusReq = varTempXML;
                                }
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("96d8b8a1-4606-45f2-b6d8-0d68a986a9e9")]
                                
                                if(System.Convert.ToString(Sp.Transpak.Common.SSOClientHelper.Read("Sp.Transpak", "ShowTranspakAdminLogs")) == "Yes")
                                {
                                    varTempXML = new System.Xml.XmlDocument();
                                    varTempXML = msgUpdStatusReq;
                                    if(varTempXML.OuterXml.Length < 30000)
                                    {
                                        System.Diagnostics.EventLog.WriteEntry("msgInvStatusUpdReq",varTempXML.OuterXml);
                                    }
                                    else
                                    {
                                        System.Diagnostics.EventLog.WriteEntry("msgInvStatusUpdReq",varTempXML.OuterXml.Substring(1,29500));
                                    }
                                }
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("e2d81894-b1fe-46ff-8360-73ddd89c72ed")]
                                send (Port_SndRcvTranspakInvStatusUpd.Operation_1, msgUpdStatusReq);
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("118ee0f2-a6aa-4868-8aa0-45d385d0353d")]
                                receive (Port_SndRcvTranspakInvStatusUpd.Operation_1, msgUpdStatusResp);
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("b55abcab-f17b-46e3-89d1-dd1cbdcc15ff")]
                                send (Port_SndTranspakInvRespFFTPPG.Operation_1, msgResponseFF);
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("472206b7-5705-4c10-979f-9875f93e97a5")]
                                
                                if(System.Convert.ToString(Sp.Transpak.Common.SSOClientHelper.Read("Sp.Transpak", "ShowTranspakAdminLogs")) == "Yes")
                                {
                                    varTempXML = new System.Xml.XmlDocument();
                                    varTempXML = msgUpdStatusResp;
                                    if(varTempXML.OuterXml.Length < 30000)
                                    {
                                        System.Diagnostics.EventLog.WriteEntry("msgUpdStatusResp",varTempXML.OuterXml);
                                    }
                                    else
                                    {
                                        System.Diagnostics.EventLog.WriteEntry("msgUpdStatusResp",varTempXML.OuterXml.Substring(0,29500));
                                    }
                                }
                            }
                        }
                        else 
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("f657317d-94be-48d0-8ba2-b3ca6ab649aa")]
                            construct msgResponseFF
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("d8674f8e-34e2-4d80-87b8-03d17bb3589a")]
                                varTempXML = new System.Xml.XmlDocument();
                                //varTempXML.LoadXml("<ns0:InvoiceResponse xmlns:ns0='http://Sp.Transpak.Schemas.TranspakInvoiceResponse'><InvoiceNumber>" + varInvoiceNo + "</InvoiceNumber><UUID></UUID><LongID></LongID><StatusCode>ValidationFailed</StatusCode><StatusMessage>" + varStatusMsg + "</StatusMessage><ValidationDateTime>" + varValidationDateTime + "</ValidationDateTime></ns0:InvoiceResponse>");
                                varTempXML.LoadXml("<InvoiceResponse><InvoiceNumber>" + varInvoiceNo + "</InvoiceNumber><UUID>-</UUID><LongID>-</LongID><StatusCode>ValidationFailed</StatusCode><StatusMessage>" + varStatusMsg + "</StatusMessage><ValidationDateTime>" + varValidationDateTime + "</ValidationDateTime></InvoiceResponse>");
                                msgResponseFF = varTempXML;
                                varFileName = "TPPG_IR_" + varInvoiceNo + "_" + System.DateTime.Now.ToString("yyyyMMddHHmmssfff") + ".xml";
                                msgResponseFF(FILE.ReceivedFileName) = varFileName;
                            }
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("6d0c4571-6263-410a-9b0e-b1067a55198e")]
                            
                            if(System.Convert.ToString(Sp.Transpak.Common.SSOClientHelper.Read("Sp.Transpak", "ShowTranspakAdminLogs")) == "Yes")
                            {
                                varTempXML = new System.Xml.XmlDocument();
                                varTempXML = msgResponseFF;
                                if(varTempXML.OuterXml.Length < 30000)
                                {
                                    System.Diagnostics.EventLog.WriteEntry("msgResponseFF",varTempXML.OuterXml);
                                }
                                else
                                {
                                    System.Diagnostics.EventLog.WriteEntry("msgResponseFF",varTempXML.OuterXml.Substring(0,29500));
                                }
                            }
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("d231a7e3-c580-451e-be8a-c0724a088beb")]
                            construct msgUpdStatusReq
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("2669cb46-5f43-42dc-a465-5d135b9a114a")]
                                varTempXML = new System.Xml.XmlDocument();
                                varTempXML.LoadXml("<ns0:InterfaceTranspakInvStatusUpd xmlns:ns0='http://schemas.microsoft.com/Sql/2008/05/TypedProcedures/dbo'><ns0:DocumentID>" + varDocId + "</ns0:DocumentID><ns0:StatusType>LHDN</ns0:StatusType><ns0:Status>" + varInterfaceStatus + "</ns0:Status><ns0:StatusMessage>" + varStatusMsg + "</ns0:StatusMessage><ns0:StatusDateTime>" + varValidationDateTime + "</ns0:StatusDateTime><ns0:PeppolInvoiceXMLPath>-</ns0:PeppolInvoiceXMLPath></ns0:InterfaceTranspakInvStatusUpd>");
                                msgUpdStatusReq = varTempXML;
                            }
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("6e131634-97c3-4fca-b654-07fb7b050d46")]
                            
                            if(System.Convert.ToString(Sp.Transpak.Common.SSOClientHelper.Read("Sp.Transpak", "ShowTranspakAdminLogs")) == "Yes")
                            {
                                varTempXML = new System.Xml.XmlDocument();
                                varTempXML = msgUpdStatusReq;
                                if(varTempXML.OuterXml.Length < 30000)
                                {
                                    System.Diagnostics.EventLog.WriteEntry("msgInvStatusUpdReq",varTempXML.OuterXml);
                                }
                                else
                                {
                                    System.Diagnostics.EventLog.WriteEntry("msgInvStatusUpdReq",varTempXML.OuterXml.Substring(1,29500));
                                }
                            }
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("b76720d8-080f-4e18-9627-dba9d3da9d49")]
                            send (Port_SndRcvTranspakInvStatusUpd.Operation_1, msgUpdStatusReq);
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("33358af0-4fd5-456f-9a82-5439e30911cf")]
                            receive (Port_SndRcvTranspakInvStatusUpd.Operation_1, msgUpdStatusResp);
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("817b99a1-939c-45a2-a883-a84d8e8c0d90")]
                            send (Port_SndTranspakInvRespFFTPPG.Operation_1, msgResponseFF);
                        }
                    }
                    exceptions
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("0c069be8-373d-40cb-be5e-4627442a96b2")]
                        catch (System.Exception ex)
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("20e0926a-b037-49ab-99b7-c60460400e12")]
                            System.Diagnostics.EventLog.WriteEntry("TranspakTSPAPIUpdateException",ex.Message);
                            varExceptionmsg = ex.Message;
                            varExceptionmsg = varExceptionmsg.Replace("&","&amp;");
                            varExceptionmsg = varExceptionmsg.Replace("'","''");
                            varExceptionmsg = varExceptionmsg.Replace("<","&lt;");
                            varExceptionmsg = varExceptionmsg.Replace(">","&gt;");
                            if(varExceptionmsg.Length > 1000)
                            {
                                varExceptionmsg = varExceptionmsg.Substring(0,999);
                            }
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("30da2980-58ad-4d88-968a-7d6cb5829bb9")]
                            construct msgErrorLogs
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("7d744bf0-d4f5-46df-9f1c-3be39c35415d")]
                                varTempXML = new System.Xml.XmlDocument();
                                varTempXML.LoadXml("<ns0:InterfaceErrorLogs xmlns:ns0='http://schemas.microsoft.com/Sql/2008/05/TypedProcedures/dbo'><ns0:HubID>TPGG</ns0:HubID><ns0:DocumentID>" + varDocId + "</ns0:DocumentID><ns0:DocumentType>TSPInvoiceResponse</ns0:DocumentType><ns0:DocumentNumber>" + varInvoiceNo + "</ns0:DocumentNumber><ns0:ModuleName>Process_TranspakInvResponse_TSP</ns0:ModuleName><ns0:ExceptionType>" + ex.Source + "</ns0:ExceptionType><ns0:ErrorMessage>" + varExceptionmsg + "</ns0:ErrorMessage><ns0:VendorCode>-</ns0:VendorCode><ns0:DocumentPath>-</ns0:DocumentPath></ns0:InterfaceErrorLogs>");
                                msgErrorLogs.Body = varTempXML;
                                
                            }
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("7ee369ab-ec62-4fa2-bdb4-7a7b469cc579")]
                            send (Port_SndTranspakErrorLogs.Operation_1, msgErrorLogs);
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("c4603a7b-aa17-48f3-8aaf-61e4e24005b3")]
                            construct msgErrorEmail
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("0f282479-b5e8-4f28-a2f3-06864aa6fb66")]
                                System.Diagnostics.EventLog.WriteEntry("TranspakTPGGInvRespException",ex.Message);
                                
                                varEmailBody = new System.Text.StringBuilder();
                                varEmailBody.AppendLine("<html><body>");
                                varEmailBody.AppendLine("<p>Transpak_TPGG Invoice Resp Status update failed while Updating in SESAMi.</p>");
                                varEmailBody.AppendLine("<p><b><u>Error details:</u></b></p><p>");
                                varEmailBody.AppendLine("<b>Application Name</b> : <i>Sp.Transpak</i><br/>");
                                varEmailBody.AppendLine("<b>Process Name</b> : <i>Process_TranspakInvResponse_TPGG</i><br/>");
                                varEmailBody.AppendLine("<b>DocId</b> : <i>" + varDocId  + "</i><br/>");
                                varEmailBody.AppendLine("<b>Failure Code</b> : " + ex.Source + "<br/>");
                                varEmailBody.AppendLine("<b>Error Description</b> : <i>" + ex.Message + "</i><br/>");
                                varEmailBody.AppendLine("</body></html>");
                                msgErrorEmail.Body = new Sp.Transpak.Common.RawString(varEmailBody.ToString());
                                Sp.Transpak.Common.SMTPUtils.SetContentType(msgErrorEmail.Body,"text/html");
                                Port_SndTranspakTSPInvRespErrorEmail(Microsoft.XLANGs.BaseTypes.Address) = Sp.Transpak.Common.SSOClientHelper.Read("Sp.Transpak", "SMTPTo");
                                
                                msgErrorEmail(SMTP.From) = Sp.Transpak.Common.SSOClientHelper.Read("Sp.Transpak", "SMTPFrom");
                                
                                msgErrorEmail(SMTP.Subject) = "Transpak TPGG Invoice Resp status failed while updating status for Invoice: " + varInvoiceNo;
                                
                                msgErrorEmail(SMTP.EmailBodyFileCharset) = "UTF-8";
                                msgErrorEmail(SMTP.CC) = Sp.Transpak.Common.SSOClientHelper.Read("Sp.Transpak", "SMTPCCopy");
                                msgErrorEmail(SMTP.SMTPHost)= Sp.Transpak.Common.SSOClientHelper.Read("Sp.Transpak", "SMTPHost");
                            }
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("44551b82-33ba-4ddf-8a76-26004d92d331")]
                            send (Port_SndTranspakTSPInvRespErrorEmail.Operation_1, msgErrorEmail);
                        }
                    }
                }
                [Microsoft.XLANGs.BaseTypes.DesignerPosition("ca7eda8b-607e-4aba-b4cf-8df0b849c016")]
                delay new System.TimeSpan(0,0,0,0,System.Convert.ToInt32(Sp.Transpak.Common.SSOClientHelper.Read("Sp.Transpak", "TranspakDelayinMS")));
            }
            [Microsoft.XLANGs.BaseTypes.DesignerPosition("f933b88e-a133-4b8e-925b-47900751f713")]
            System.Diagnostics.EventLog.WriteEntry("Transpak_TPPG Invoice Response Process End","Transpak_TPPG Invoice Response Process Completed");
        }
    }
}

